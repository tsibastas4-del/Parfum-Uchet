<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>‚ú® –û–±–ª—ñ–∫ –†–æ–∑–ª–∏–≤—É –ü–∞—Ä—Ñ—É–º—ñ–≤ V11.1</title>
    <link rel="icon" type="image/png" href="perfume_favicon.png">
    <style>
        /* =================================================================== */
        /* ==================== –ï–°–¢–ï–¢–ò–ß–ù–Ü –û–ù–û–í–õ–ï–ù–ù–Ø V11.1 (–ü—Ä–∞–π—Å-–ª–∏—Å—Ç) =================== */
        /* =================================================================== */

        /* Main Styling */
body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f9;
 
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: #fff;
    padding: 30px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
}

input[type="text"], input[type="number"], button {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    box-sizing: border-box;
    border-radius: 4px;
    border: 1px solid #ccc;
}

button {
    background-color: #007bff;
    color: white;
    cursor: pointer;
    font-size: 16px;
    border: none;
}

button:hover {
    background-color: #0056b3;
}

hr {
    margin: 30px 0;
    border: 0;
    border-top: 1px solid #eee;
}

.message {
    font-weight: bold;
    margin-top: -10px;
    margin-bottom: 15px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –û—Ç—á–µ—Ç–∞ */
.report-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.report-table th, .report-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.report-table th {
    background-color: #f2f2f2;
}

.profit {
    font-weight: bold;
    background-color: #d4edda;
}
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e9ebee; 
            color: #333;
            padding-top: 70px; 
            line-height: 1.5;
        }
        .container {
            max-width: 950px;
            margin: 20px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); 
        }
        h1 {
            color: #004085; 
            font-size: 2.5em;
            text-align: center;
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 20px;
        }
        h2 {
            color: #0056b3; 
            border-bottom: 2px solid #a3ccff; 
            padding-bottom: 8px;
            margin-top: 30px;
        }
        h3 {
             color: #333;
             margin-top: 25px;
             font-size: 1.3em;
        }
        
        /* Navigation Bar */
        .navbar {
            overflow: hidden;
            background-color: #004085; 
            position: fixed;
            top: 0;
            width: 100%; 
            z-index: 1000;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between; 
            padding: 0 20px; 
            box-sizing: border-box; 
        }
        
        .navbar-brand {
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            display: flex;
            align-items: center;
            height: 100%;
            white-space: nowrap;
        }
        .navbar-brand span {
            margin-right: 10px;
            font-size: 1.2em; 
        }
        
        .navbar-links {
            display: flex;
            align-items: center;
            height: 100%;
        }
        
        .navbar a {
            float: none; 
            display: block;
            color: white;
            text-align: center;
            padding: 0 15px; 
            height: 100%;
            display: flex;
            align-items: center;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            border-right: 1px solid #0056b3;
            transition: background-color 0.3s, color 0.3s;
        }
        .navbar a:last-child {
            border-right: none;
        }
        .navbar a:hover {
            background-color: #0056b3;
        }
        .navbar a.active {
            background-color: #17a2b8; 
            color: white;
            box-shadow: inset 0 -3px 0 0 #ffc107; 
        }

        /* Section Visibility Logic */
        .content-section {
            display: none; 
        }
        .content-section.active {
            display: block; 
        }
        
        /* Collapsible Logic */
        .collapsible-content {
            max-height: 0; 
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0 0; 
        }
        .collapsible-content.active {
            max-height: 2000px; 
            padding: 10px 0; 
        }


        /* Form Elements */
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
            color: #555;
            font-size: 0.95em;
        }
        input[type="text"], input[type="number"], input[type="date"], select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            margin-bottom: 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input:focus, select:focus {
            border-color: #80bdff;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        /* Buttons */
        button {
            background-color: #0056b3;
            color: white;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s, transform 0.1s, box-shadow 0.2s;
            margin-bottom: 10px;
            padding: 10px 15px;
            box-sizing: border-box;
        }
        button:hover {
            background-color: #004085;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .action-button {
            background-color: #6c757d; 
            padding: 5px 10px; 
            margin: 2px;
        }
        .action-button:hover {
            background-color: #5a6268;
        }
        .clear-button {
            background-color: #dc3545; 
        }
        .clear-button:hover {
            background-color: #c82333;
        }
        
        /* Messages */
        .message {
            padding: 12px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 1.05em;
            font-weight: 500;
        }
        
        /* Admin Panel and Collapsible */
        #admin-panel {
            background-color: #f8f9fa; 
            border: 1px solid #ced4da;
            border-radius: 8px;
            padding: 20px;
        }
        .collapsible-header {
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            color: #0056b3;
            background-color: #e9ecef;
            border-radius: 6px;
            margin-top: 15px;
            transition: background-color 0.2s;
        }
        .collapsible-header:hover {
            background-color: #dee2e6;
        }
       
        /* Tables */
        .table-responsive {
            overflow-x: auto; 
            width: 100%;
            -webkit-overflow-scrolling: touch; 
        }
        
        #perfume-list-table, #flacon-list-table, .report-table, #order-list-table, #expense-list-table, #transaction-history-table, #markup-presets-table, #sales-sources-table, #client-history-table {
            width: 100%;
            min-width: 600px; 
            border-collapse: separate; 
            border-spacing: 0;
            margin-top: 15px;
            font-size: 0.9em;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            overflow: hidden; 
        }
        #perfume-list-table th, #flacon-list-table th, .report-table th, #order-list-table th, #expense-list-table th, #transaction-history-table th, #markup-presets-table th, #sales-sources-table th, #client-history-table th,
        #perfume-list-table td, #flacon-list-table td, .report-table td, #order-list-table td, #expense-list-table td, #transaction-history-table td, #markup-presets-table td, #sales-sources-table td, #client-history-table td {
            padding: 12px 10px;
            border-color: #dee2e6;
            border-left: none;
            border-right: none;
        }
        #perfume-list-table th, #flacon-list-table th, .report-table th, #order-list-table th, #expense-list-table th, #transaction-history-table th, #markup-presets-table th, #sales-sources-table th, #client-history-table th {
            background-color: #0056b3; 
            color: white;
            text-align: center;
            font-weight: 600;
            border-bottom: 2px solid #004085;
        }
        #perfume-list-table tbody tr:nth-child(even), #flacon-list-table tbody tr:nth-child(even), #order-list-table tbody tr:nth-child(even), #expense-list-table tbody tr:nth-child(even), #transaction-history-table tbody tr:nth-child(even), #markup-presets-table tbody tr:nth-child(even), #sales-sources-table tbody tr:nth-child(even), #client-history-table tbody tr:nth-child(even) {
            background-color: #f8f9fa; 
        }
        #perfume-list-table td:nth-child(2), #perfume-list-table td:nth-child(4), #perfume-list-table td:nth-child(5) {
             text-align: right;
        }
        #transaction-history-table td:nth-child(4), #transaction-history-table td:nth-child(5) {
             text-align: right;
        }

        /* Highlighted Data (Totals/Calculator) */
        .order-total {
            font-size: 1.8em;
            font-weight: bold;
            background-color: #ffc107; 
            color: #333;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            margin-top: 20px;
            border: 2px solid #ff9800;
        }
        /* Calculator Result */
        #calcResult div:first-child {
            background-color: #ffc107; 
            color: #333;
            border: 2px solid #ff9800;
            font-size: 1.5em; 
            padding: 15px;
            border-radius: 5px; 
            text-align: center;
            margin-bottom: 15px;
        }
        
        /* Report Net Profit Highlight */
        .report-table tr:last-child {
            font-size: 1.2em;
            background-color: #d4edda !important; 
            color: #155724 !important;
            border-top: 2px solid #28a745;
        }
        .report-table tr:last-child td {
            font-weight: bold;
        }
        
        /* Client Summary Output */
        #clientSummaryOutput {
            background-color: #fff3cd; 
            color: #856404;
            border: 1px solid #ffeeba;
            padding: 15px;
            border-radius: 5px; 
            white-space: pre-wrap;
            font-size: 1.1em;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        /* CRM Summary Box */
        #clientCrmSummary {
             background-color: #e6f7ff; 
             border: 2px solid #b3d9ff;
             padding: 20px;
             border-radius: 8px;
             margin-top: 20px;
             line-height: 1.8;
             font-size: 1.1em;
        }

        /* Modal (Receipt) Styling */
        .modal {
            display: none; 
            position: fixed;
            z-index: 2000; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4); 
        }
        .modal.active {
            display: block;
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 90%; 
            max-width: 500px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* Receipt Specific Styling */
        .receipt-header {
            text-align: center;
            border-bottom: 2px solid #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
        }
        .receipt-header h3 {
            margin: 5px 0;
            color: #004085;
            font-size: 1.5em;
        }
        .receipt-item-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        .receipt-item-table th, .receipt-item-table td {
            padding: 8px 0;
            text-align: left;
            border-bottom: 1px dashed #ccc;
            font-size: 1.0em;
        }
        .receipt-item-table th:last-child, .receipt-item-table td:last-child {
            text-align: right;
        }
        .receipt-total {
            font-size: 1.4em;
            font-weight: bold;
            text-align: right;
            padding: 10px 0;
            border-top: 2px solid #333;
        }
        .receipt-footer {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9em;
            color: #555;
        }
        
        .grid-3-col {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        /* Responsive Fix for Navbar and General Layout (ADAPTIVE DESIGN) */
        @media screen and (max-width: 800px) {
            .navbar {
                 height: auto;
                 display: block;
                 padding: 0; 
            }
            .navbar-brand {
                 display: block;
                 padding: 10px 15px;
                 border-bottom: 1px solid #0056b3;
                 font-size: 1.2em; 
            }
            .navbar-links {
                 display: flex; 
                 flex-wrap: wrap; 
                 justify-content: space-around;
            }
            .navbar a {
                /* 8 links total: 4 on the first row, 4 on the second */
                width: 24%; 
                text-align: center;
                padding: 10px 5px;
                border-right: 1px solid #0056b3;
                box-sizing: border-box;
                font-size: 11px; 
            }
            /* Fix borders for the 4-column layout */
            .navbar a:nth-child(4), .navbar a:nth-child(8) {
                border-right: none;
            }
            
            .container {
                margin: 10px auto;
                padding: 15px;
            }
            
            h1 {
                 font-size: 2em;
            }

            /* Stack elements in groups */
            .date-input-group, .admin-buttons-group, .grid-3-col {
                display: block !important;
            }
            .date-input-group > div, .admin-buttons-group > div, .grid-3-col > div {
                margin-bottom: 10px;
            }
            
            /* Full width buttons */
            button {
                width: 100%;
                margin-top: 5px;
            }
            
            /* Smaller tables for mobile view */
            #perfume-list-table, #flacon-list-table, .report-table, #order-list-table, #expense-list-table, #transaction-history-table, #markup-presets-table, #sales-sources-table, #client-history-table {
                 min-width: 300px; /* Reduced min-width for mobile */
                 font-size: 0.8em;
            }
            #transaction-history-table th:nth-child(3), #transaction-history-table td:nth-child(3),
            #transaction-history-table th:nth-child(4), #transaction-history-table td:nth-child(4) {
                 display: none; /* Hide some columns on mobile for better fit */
            }
        }
        
        /* Print Styles */
        @media print {
            body > *:not(.modal) {
                display: none;
            }
            .modal {
                display: block !important;
                position: absolute;
                left: 0;
                top: 0;
                background-color: white;
            }
            .modal-content {
                margin: 0;
                padding: 0;
                width: 100%;
                max-width: 100%;
                box-shadow: none;
                border: none;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div id="receiptModal" class="modal" onclick="if(event.target === this) closeReceiptModal()">
        <div class="modal-content" id="receiptContent">
            </div>
    </div>

    <div class="navbar" id="main-nav">
        <div class="navbar-brand">
            <span>‚ú®</span> PerfumeFlow V11.1
        </div>
        
        <div class="navbar-links">
            <a href="javascript:void(0)" onclick="showSection('input-form', this)" class="active">1. –ü—Ä–æ–¥–∞–∂</a>
            <a href="javascript:void(0)" onclick="showSection('multi-calculator', this)">2. –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
            <a href="javascript:void(0)" onclick="showSection('calculator', this)">3. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a>
            <a href="javascript:void(0)" onclick="showSection('expenses', this)">4. –í–∏—Ç—Ä–∞—Ç–∏</a>
            <a href="javascript:void(0)" onclick="showSection('report', this)">5. –ó–≤—ñ—Ç</a>
            <a href="javascript:void(0)" onclick="showSection('transactions', this)">6. –Ü—Å—Ç–æ—Ä—ñ—è –ü—Ä–æ–¥–∞–∂—ñ–≤</a>
            <a href="javascript:void(0)" onclick="showSection('client-crm', this)">7. –Ü—Å—Ç–æ—Ä—ñ—è –ö–ª—ñ—î–Ω—Ç–∞ (CRM)</a>
            <a href="javascript:void(0)" onclick="showSection('admin-panel', this)">8. –î–æ–≤—ñ–¥–Ω–∏–∫–∏</a>
        </div>
    </div>

    <div class="container">
        <h1>üìä –û–±–ª—ñ–∫ –†–æ–∑–ª–∏–≤—É –ü–∞—Ä—Ñ—É–º—ñ–≤ V11.1</h1>
    

        <section id="input-form" class="content-section active">
            <h2>1. –î–æ–¥–∞—Ç–∏ –û–¥–∏–Ω–∏—á–Ω–∏–π –ü—Ä–æ–¥–∞–∂</h2>
            
            <div class="grid-3-col">
                <div>
                    <label for="saleMarkupTierSingle">–¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏:</label>
                    <select id="saleMarkupTierSingle"></select>
                </div>
                <div>
                    <label for="saleSourceSingle">–î–∂–µ—Ä–µ–ª–æ –ü—Ä–æ–¥–∞–∂—É (–û–ø—Ü—ñ–π–Ω–æ):</label>
                    <select id="saleSourceSingle"></select>
                </div>
                <div>
                    <label for="clientNameSingle">–Ü–º'—è –ö–ª—ñ—î–Ω—Ç–∞ (–û–ø—Ü—ñ–π–Ω–æ):</label>
                    <input type="text" id="clientNameSingle" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –û–ª–µ–Ω–∞" list="clientList">
                </div>
            </div>
            
            <label for="perfumeName">–ù–∞–∑–≤–∞ –ü–∞—Ä—Ñ—É–º—É:</label>
            <input type="text" id="perfumeName" list="perfumeList" placeholder="Aventus Creed">

            <label for="flaconVolume">–û–±—Å—è–≥ –§–ª–∞–∫–æ–Ω—É (–º–ª):</label>
            <select id="flaconVolume"></select>
            
            <button onclick="addSale()">–ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –ü—Ä–æ–¥–∞–∂</button>
            <p id="message" class="message"></p>
        </section>

        
        <section id="multi-calculator" class="content-section">
            <h2>2. üõí –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
            
            <p style="font-size: 0.9em; color: #555;">
                –î–æ–¥–∞–π—Ç–µ –∫—ñ–ª—å–∫–∞ –ø–æ–∑–∏—Ü—ñ–π –¥–æ –æ–¥–Ω–æ–≥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—É–º–∏ –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞.
            </p>
            
            <div class="grid-3-col">
                 <div>
                    <label for="saleMarkupTierOrder">–¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏:</label>
                    <select id="saleMarkupTierOrder"></select>
                </div>
                <div>
                    <label for="saleSourceOrder">–î–∂–µ—Ä–µ–ª–æ –ü—Ä–æ–¥–∞–∂—É (–û–ø—Ü—ñ–π–Ω–æ):</label>
                    <select id="saleSourceOrder"></select>
                </div>
                <div>
                    <label for="clientNameOrder">–Ü–º'—è –ö–ª—ñ—î–Ω—Ç–∞ (–û–ø—Ü—ñ–π–Ω–æ):</label>
                    <input type="text" id="clientNameOrder" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ü–≥–æ—Ä" list="clientList">
                </div>
            </div>

            <div style="display: flex; gap: 10px;">
                <div style="flex-grow: 1;">
                    <label for="orderPerfumeName">–ü–∞—Ä—Ñ—É–º:</label>
                    <input type="text" id="orderPerfumeName" list="perfumeList" placeholder="–ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É">
                </div>
                <div>
                    <label for="orderFlaconVolume">–û–±'—î–º (–º–ª):</label>
                    <select id="orderFlaconVolume" style="width: 100%;"></select>
                </div>
            </div>
            
            <button onclick="addItemToOrder()">‚ûï –î–æ–¥–∞—Ç–∏ –¥–æ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
            <p id="orderMessage" class="message"></p>

            <h3>–°–ø–∏—Å–æ–∫ –ü–æ–∑–∏—Ü—ñ–π –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è:</h3>
            <div class="table-responsive">
                <table id="order-list-table">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞ –ü–∞—Ä—Ñ—É–º—É</th>
                            <th>–û–±'—î–º (–º–ª)</th>
                            <th>–¶—ñ–Ω–∞ –¥–ª—è –ö–ª—ñ—î–Ω—Ç–∞ (–∑ –æ–∫—Ä—É–≥–ª. –ø–∞—Ä—Ñ—É–º—É)</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
            
            <div id="orderTotalSection" style="margin-top: 20px;">
                </div>

            <h3 style="margin-top: 30px;">–§–æ—Ä–º–∞ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è –ö–ª—ñ—î–Ω—Ç–∞ (–ö–æ–ø—ñ—é–≤–∞—Ç–∏):</h3>
            <pre id="clientSummaryOutput">–°–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ–π.</pre>
            <div style="display: flex; gap: 10px; margin-top: 20px;" class="admin-buttons-group">
                <button onclick="processOrder()" style="background-color: #28a745; flex-grow: 1;">üí∏ –ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –ü—Ä–æ–¥–∞–∂ —Ç–∞ –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ß–µ–∫</button>
                <button onclick="clearOrder()" style="background-color: #6c757d; width: 150px; flex-grow: 1;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –°–ø–∏—Å–æ–∫</button>
            </div>
        </section>

        
        <section id="calculator" class="content-section">
            <h2>3. üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –û–¥–∏–Ω–∏—á–Ω–æ—ó –¶—ñ–Ω–∏ (–¶—ñ–Ω–∞ –ö–ª—ñ—î–Ω—Ç—É)</h2>
            
            <label for="calcMarkupTier">–¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏:</label>
            <select id="calcMarkupTier" onchange="calculatePrice()"></select>

            <label for="calcPerfumeName">–ù–∞–∑–≤–∞ –ü–∞—Ä—Ñ—É–º—É:</label>
            <input type="text" id="calcPerfumeName" list="perfumeList" placeholder="Baccarat Rouge 540">
            
            <label for="calcFlaconVolume">–û–±'—î–º –§–ª–∞–∫–æ–Ω—É (–º–ª):</label>
            <select id="calcFlaconVolume" onchange="calculatePrice()"></select>
            
            <button onclick="calculatePrice()">–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –¶—ñ–Ω—É</button>
            
            <div id="calcResult" class="message">
                </div>
        </section>

        
        <section id="expenses" class="content-section">
            <h2>4. üìâ –ù–æ–≤—ñ –í–∏—Ç—Ä–∞—Ç–∏ (–û—Ä–µ–Ω–¥–∞, –ó–∞–∫—É–ø—ñ–≤–ª—ñ –§–ª–∞–∫–æ–Ω—ñ–≤ —Ç–æ—â–æ)</h2>
            
            <label for="expenseDescription">–û–ø–∏—Å –í–∏—Ç—Ä–∞—Ç–∏:</label>
            <input type="text" id="expenseDescription" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –û—Ä–µ–Ω–¥–∞ —Å–∫–ª–∞–¥—É –∑–∞ —Ç—Ä–∞–≤–µ–Ω—å" required>

            <label for="expenseAmount">–°—É–º–∞ –í–∏—Ç—Ä–∞—Ç–∏ (UAH):</label>
            <input type="number" id="expenseAmount" step="0.01" min="0.01" placeholder="5000" required>
            
            <button onclick="addExpense()">–ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –í–∏—Ç—Ä–∞—Ç—É</button>
            <p id="expenseMessage" class="message"></p>

            <h3>–°–ø–∏—Å–æ–∫ –ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏—Ö –í–∏—Ç—Ä–∞—Ç:</h3>
            <div class="table-responsive">
                <table id="expense-list-table">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–û–ø–∏—Å</th>
                            <th>–°—É–º–∞ (UAH)</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        
        <section id="report" class="content-section">
            <h2>5. üßæ –ó–≤—ñ—Ç –ø—Ä–æ –î–æ—Ö–æ–¥–∏/–í–∏—Ç—Ä–∞—Ç–∏</h2>

            <div class="date-input-group" style="display: flex; gap: 10px;">
                <div style="flex-grow: 1;">
                    <label for="startDate">–ü–æ—á–∞—Ç–∫–æ–≤–∞ –î–∞—Ç–∞:</label>
                    <input type="date" id="startDate">
                </div>
                <div style="flex-grow: 1;">
                    <label for="endDate">–ö—ñ–Ω—Ü–µ–≤–∞ –î–∞—Ç–∞:</label>
                    <input type="date" id="endDate">
                </div>
            </div>
            
            <button onclick="generateReport()">–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ó–≤—ñ—Ç</button>
            <div id="reportOutput">
                </div>
        </section>
        
        <section id="transactions" class="content-section">
            <h2>6. üìú –î–µ—Ç–∞–ª—å–Ω–∏–π –ñ—É—Ä–Ω–∞–ª –ü—Ä–æ–¥–∞–∂—ñ–≤ —Ç–∞ –Ü—Å—Ç–æ—Ä—ñ—è</h2>
            
            <div class="grid-3-col">
                <div>
                     <label for="transactionSearch">üîç –ü–æ—à—É–∫ (–ù–∞–∑–≤–∞/–ö–ª—ñ—î–Ω—Ç):</label>
                     <input type="text" id="transactionSearch" onkeyup="renderTransactionHistory()" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –ø–∞—Ä—Ñ—É–º—É –∞–±–æ –∫–ª—ñ—î–Ω—Ç–∞...">
                </div>
                <div>
                    <label for="historyFilterSource">–§—ñ–ª—å—Ç—Ä –î–∂–µ—Ä–µ–ª–∞:</label>
                    <select id="historyFilterSource" onchange="renderTransactionHistory()"></select>
                </div>
                <div>
                    <label for="historyFilterMarkup">–§—ñ–ª—å—Ç—Ä –ù–∞—Ü—ñ–Ω–∫–∏:</label>
                    <select id="historyFilterMarkup" onchange="renderTransactionHistory()"></select>
                </div>
            </div>

            <div class="date-input-group" style="display: flex; gap: 10px; margin-top: 10px;">
                <div style="flex-grow: 1;">
                    <label for="historyStartDate">–ü–æ—á–∞—Ç–∫–æ–≤–∞ –î–∞—Ç–∞:</label>
                    <input type="date" id="historyStartDate" onchange="renderTransactionHistory()">
                </div>
                <div style="flex-grow: 1;">
                    <label for="historyEndDate">–ö—ñ–Ω—Ü–µ–≤–∞ –î–∞—Ç–∞:</label>
                    <input type="date" id="historyEndDate" onchange="renderTransactionHistory()">
                </div>
            </div>

            <button onclick="renderTransactionHistory()" style="margin-top: 10px;">–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>

            <div class="table-responsive" style="margin-top: 20px;">
                <table id="transaction-history-table">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞/–ß–∞—Å</th>
                            <th>–ö–ª—ñ—î–Ω—Ç</th>
                            <th>–î–∂–µ—Ä–µ–ª–æ / –ù–∞—Ü—ñ–Ω–∫–∞</th>
                            <th>–ü–∞—Ä—Ñ—É–º (–º–ª)</th>
                            <th>–í–∏—Ä—É—á–∫–∞ (UAH)</th>
                            <th>–ü—Ä–∏–±—É—Ç–æ–∫ (UAH)</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <p id="transactionSummary" class="message" style="margin-top: 20px;"></p>
        </section>
        
        
        <section id="client-crm" class="content-section">
            <h2>7. üîé –Ü—Å—Ç–æ—Ä—ñ—è –ö–ª—ñ—î–Ω—Ç–∞ (Simple CRM)</h2>
            <p style="font-size: 0.9em; color: #555;">
                –®—É–∫–∞–π—Ç–µ –∫–ª—ñ—î–Ω—Ç–∞ –∑–∞ —ñ–º–µ–Ω–µ–º, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –π–æ–≥–æ –∫—É–ø—ñ–≤–µ–ª—å–Ω—É —ñ—Å—Ç–æ—Ä—ñ—é —Ç–∞ –∑–∞–≥–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏.
            </p>

            <label for="clientSearchInput">–Ü–º'—è –ö–ª—ñ—î–Ω—Ç–∞:</label>
            <input type="text" id="clientSearchInput" list="clientList" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è –∫–ª—ñ—î–Ω—Ç–∞ (–Ω–∞–ø—Ä. –û–ª–µ–Ω–∞)">
            <datalist id="clientList"></datalist>

            <button onclick="showClientHistory()">–ü–æ–∫–∞–∑–∞—Ç–∏ –Ü—Å—Ç–æ—Ä—ñ—é –ö–ª—ñ—î–Ω—Ç–∞</button>
            
            <div id="clientCrmSummary">
                </div>

            <h3>–î–µ—Ç–∞–ª—å–Ω—ñ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –ö–ª—ñ—î–Ω—Ç–∞:</h3>
            <div class="table-responsive">
                <table id="client-history-table">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞/–ß–∞—Å</th>
                            <th>–ü–∞—Ä—Ñ—É–º (–º–ª)</th>
                            <th>–í–∏—Ä—É—á–∫–∞ (UAH)</th>
                            <th>–ü—Ä–∏–±—É—Ç–æ–∫ (UAH)</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </section>
        
        
        <section id="admin-panel" class="content-section">
            <h2>8. ‚öôÔ∏è –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –î–æ–≤—ñ–¥–Ω–∏–∫–∞–º–∏ (–¶—ñ–Ω–∏ –ó–∞–∫—É–ø—ñ–≤–ª—ñ, –ù–∞—Ü—ñ–Ω–∫–∞, –î–∂–µ—Ä–µ–ª–∞)</h2>
            <p style="font-weight: bold; color: green;">
                ‚úÖ –í–∞—à—ñ –¥–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –ø–∞–º'—è—Ç—ñ –±—Ä–∞—É–∑–µ—Ä–∞ (Local Storage).
            </p>
            
            <button onclick="saveInitialDataToLocalStorage()">–°–∫–∏–Ω—É—Ç–∏ —Ç–∞ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –°—Ç–∞—Ä—Ç–æ–≤—ñ –¶—ñ–Ω–∏ (–£ –≤–∏–ø–∞–¥–∫—É –ø—Ä–æ–±–ª–µ–º)</button>
            <div id="admin-message" class="message" style="display: none;"></div>
            
            <hr>
            <h3>üí∏ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ù–∞—Ü—ñ–Ω–∫–∞–º–∏ (Tiered Pricing)</h3>
            <p>
                **–ù–∞—Ü—ñ–Ω–∫–∞** ‚Äî —Ü–µ –≤—ñ–¥—Å–æ—Ç–æ–∫, –Ω–∞ —è–∫–∏–π –º–Ω–æ–∂–∏—Ç—å—Å—è —Å–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–∞—Ä—Ñ—É–º—É (–°/–°) –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –≤–∞—Ä—Ç–æ—Å—Ç—ñ —Ñ–ª–∞–∫–æ–Ω—É. <br>
                <em>–¶—ñ–Ω–∞ –ü—Ä–æ–¥–∞–∂—É = **–û–∫—Ä—É–≥–ª–µ–Ω–∏–π (–°/–° * (1 + –ù–∞—Ü—ñ–Ω–∫–∞) * –û–±—Å—è–≥)** + –í–∞—Ä—Ç—ñ—Å—Ç—å –§–ª–∞–∫–æ–Ω—É.</em>
            </p>
            
            <h4>‚ûï –î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏</h4>
            <label for="adminMarkupName">–ù–∞–∑–≤–∞ –ù–∞—Ü—ñ–Ω–∫–∏ (–Ω–∞–ø—Ä. –†–æ–∑–¥—Ä—ñ–±, –û–ø—Ç):</label>
            <input type="text" id="adminMarkupName" placeholder="–ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –†–æ–∑–¥—Ä—ñ–±–Ω–∞)">
            
            <label for="adminMarkupValue">–í—ñ–¥—Å–æ—Ç–æ–∫ –ù–∞—Ü—ñ–Ω–∫–∏ (–Ω–∞–ø—Ä. 0.15 –¥–ª—è 15%):</label>
            <input type="number" id="adminMarkupValue" step="0.01" min="0.01" max="0.5" placeholder="0.15">
            <button onclick="addOrUpdateMarkupPreset()">–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏</button>

            <div class="table-responsive">
                <table id="markup-presets-table">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞ –¢–∏–ø—É –ù–∞—Ü—ñ–Ω–∫–∏</th>
                            <th>–í—ñ–¥—Å–æ—Ç–æ–∫</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            
            <hr>
            <h3>üìç –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –î–∂–µ—Ä–µ–ª–∞–º–∏ –ü—Ä–æ–¥–∞–∂—É (Source Tracking)</h3>
            
            <h4>‚ûï –î–æ–¥–∞—Ç–∏ –î–∂–µ—Ä–µ–ª–æ</h4>
            <label for="adminSourceName">–ù–∞–∑–≤–∞ –î–∂–µ—Ä–µ–ª–∞ (–Ω–∞–ø—Ä. OLX, Instagram, –†–µ—Ñ–µ—Ä–∞–ª):</label>
            <input type="text" id="adminSourceName" placeholder="–ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, OLX-–î–æ—Å—Ç–∞–≤–∫–∞)">
            <button onclick="addOrUpdateSalesSource()">–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –î–∂–µ—Ä–µ–ª–æ</button>

             <div class="table-responsive">
                <table id="sales-sources-table">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞ –î–∂–µ—Ä–µ–ª–∞</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>

            <hr>
            
            <h4>‚ûï –î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –ü–∞—Ä—Ñ—É–º (–°/–°)</h4>
            <label for="adminPerfumeName">–ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É:</label>
            <input type="text" id="adminPerfumeName" placeholder="–ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Aventus Creed)">
            
            <label for="adminBasePrice">–ë–∞–∑–æ–≤–∞ –¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ (–∑–∞ 1 –º–ª, –°/–°, UAH):</label>
            <input type="number" id="adminBasePrice" step="0.01" min="1" placeholder="40">
            
            <label for="adminDiscountVolume">–û–±—Å—è–≥ –∑–Ω–∏–∂–∫–∏ (–≤—ñ–¥, –º–ª):</label>
            <input type="number" id="adminDiscountVolume" min="0" placeholder="5 (0 - —è–∫—â–æ –∑–Ω–∏–∂–∫–∏ –Ω–µ–º–∞—î)">
            
            <label for="adminDiscountPrice">–¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ (–∑–∞ 1 –º–ª, –∑—ñ –∑–Ω–∏–∂–∫–æ—é, –°/–°, UAH):</label>
            <input type="number" id="adminDiscountPrice" step="0.01" min="1" placeholder="38">
            
            <button onclick="addOrUpdatePerfume()">–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ —Ü—ñ–Ω—É –∑–∞–∫—É–ø—ñ–≤–ª—ñ</button>

            <label for="perfumeSearchInput" style="margin-top: 20px;">üîç –ü–æ—à—É–∫ –ü–∞—Ä—Ñ—É–º—É (–∑–∞ –Ω–∞–∑–≤–æ—é):</label>
            <input type="text" id="perfumeSearchInput" onkeyup="renderPerfumeList()" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó...">
            <div id="perfume-list-container">
                <div class="collapsible-header" onclick="togglePerfumeList()">
                    –°–ø–∏—Å–æ–∫ –ü–∞—Ä—Ñ—É–º—ñ–≤ (–¶—ñ–Ω–∏ –ó–∞–∫—É–ø—ñ–≤–ª—ñ - –°/–°) 
                    <span id="perfume-toggle-icon">‚ñº</span>
                </div>
                <div id="perfume-content" class="collapsible-content active">
                    <div class="table-responsive">
                        <table id="perfume-list-table">
                            <thead>
                                <tr>
                                    <th>–ù–∞–∑–≤–∞</th>
                                    <th>–ë–∞–∑. –°/–° (UAH/–º–ª)</th>
                                    <th>–ó–Ω–∏–∂–∫–∞ –≤—ñ–¥ (–º–ª)</th>
                                    <th>–°/–° –∑—ñ –ó–Ω–∏–∂–∫–æ—é (UAH/–º–ª)</th>
                                    <th>–î—ñ—è</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <hr>

            <h3>–°–ª–æ–≤–Ω–∏–∫ –í–∞—Ä—Ç—ñ—Å—Ç—å –§–ª–∞–∫–æ–Ω—ñ–≤</h3>
            
            <h4>‚ûï –î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –§–ª–∞–∫–æ–Ω</h4>
            <label for="adminFlaconVolume">–û–±—Å—è–≥ –§–ª–∞–∫–æ–Ω—É (–º–ª):</label>
            <input type="number" id="adminFlaconVolume" min="1" placeholder="10">
            
            <label for="adminFlaconCost">–í–∞—Ä—Ç—ñ—Å—Ç—å –§–ª–∞–∫–æ–Ω—É (UAH):</label>
            <input type="number" id="adminFlaconCost" step="0.01" min="0" placeholder="17">
            
            <button onclick="addOrUpdateFlacon()">–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –≤–∞—Ä—Ç—ñ—Å—Ç—å —Ñ–ª–∞–∫–æ–Ω—É</button>

            <h4>–°–ø–∏—Å–æ–∫ –§–ª–∞–∫–æ–Ω—ñ–≤:</h4>
            <div class="table-responsive">
                <table id="flacon-list-table">
                    <thead>
                        <tr>
                            <th>–û–±—Å—è–≥ (–º–ª)</th>
                            <th>–í–∞—Ä—Ç—ñ—Å—Ç—å –§–ª–∞–∫–æ–Ω—É (UAH)</th>
                            <th>–î—ñ—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>

            <hr>
            <h3>üíæ –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ç–∞ –í–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ü—Ä–∞–π—Å–∞</h3>
            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                <button onclick="downloadBackup()" style="background-color: #17a2b8; flex-grow: 1;">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–≤–Ω—É –±–∞–∑—É (Backup)</button>
                <button onclick="document.getElementById('restoreFile').click()" style="background-color: #e0a800; flex-grow: 1;">‚¨ÜÔ∏è –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ —Ñ–∞–π–ª—É</button>
                <input type="file" id="restoreFile" style="display: none;" onchange="restoreBackup(this)" accept=".json">
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                <button onclick="downloadClientPriceList()" style="background-color: #28a745; flex-grow: 1;">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ü—Ä–∞–π—Å –ö–ª—ñ—î–Ω—Ç–∞ (TXT)</button>
            </div>


        </section>


        <button class="clear-button" onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç–∏ –£–°–Ü –¥–∞–Ω—ñ (–ü–æ–≤–Ω–∏–π –°–∫–∏–¥–∞–Ω–Ω—è)</button>
    </div>

    <datalist id="perfumeList"></datalist>

    <script>
        
        // --- 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –ö–ª—é—á—ñ (–û–ù–û–í–õ–ï–ù–û –î–û V11.1) ---
        const DB_NAME = 'transactionAccountingDataV11_1'; 
        const EXPENSES_KEY = 'expensesDataV11_1'; 
        const PRICES_KEY = 'perfumePricesV11_1';
        const FLACONS_KEY = 'flaconCostsV11_1';
        const VOLUMES_KEY = 'flaconVolumesV11_1';
        const MARKUP_PRESETS_KEY = 'markupPresetsV11_1'; 
        const SALES_SOURCES_KEY = 'salesSourcesV11_1'; 
        
        // --- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞ ---
        const ROUND_TO_NEAREST_UAH = true; 
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        let PERFUME_PRICES = {}; 
        let FLACON_VOLUMES = [];
        let FLACON_COSTS = {};
        let MARKUP_PRESETS = {}; 
        let SALES_SOURCES = [];  
        let CURRENT_ORDER_LIST = []; 

        // *******************************************************************
        // ********************* –í–ê–® –û–°–ù–û–í–ù–ò–ô –î–û–í–Ü–î–ù–ò–ö (–ü–û–ß–ê–¢–ö–û–í–ò–ô) ************
        // *******************************************************************
     
        const INITIAL_PERFUME_PRICES= {
             "27 87 Perfumes Genetic Bliss": { "basePrice": 160, "discountVolume": 5, "discountPrice": 155 },
                "Acqua di Parma Colonia Club": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Acqua di Parma Colonia Futura": { "basePrice": 35, "discountVolume": 5, "discountPrice": 33 },
                "Acqua di Parma Colonia Intensa": { "basePrice": 36, "discountVolume": 5, "discountPrice": 35 },
                "Acqua di Parma Colonia Pura": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
                "Afnan 9 PM Black": { "basePrice": 20, "discountVolume": 10, "discountPrice": 18 },
                "Afnan 9 PM Rebel": { "basePrice": 20, "discountVolume": 5, "discountPrice": 18 },
                "Afnan 9am Pour Femme": { "basePrice": 20, "discountVolume": 5, "discountPrice": 18 },
                "Afnan 9pm Pour Femme": { "basePrice": 18, "discountVolume": 5, "discountPrice": 16 },
                "Afnan Cherry Bouquet": { "basePrice": 35, "discountVolume": 5, "discountPrice": 30 },
                "Afnan La Fleur Bouquet": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Afnan Mirsaal With Love": { "basePrice": 23, "discountVolume": 5, "discountPrice": 22 },
                "Afnan Mirsaal of Trust": { "basePrice": 25, "discountVolume": 5, "discountPrice": 24 },
                "Afnan Rare Carbon": { "basePrice": 22, "discountVolume": 5, "discountPrice": 21 },
                "Afnan Supremacy Collector's Edition": { "basePrice": 30, "discountVolume": 5, "discountPrice": 27 },
                "Afnan Supremacy Femme Pink": { "basePrice": 24, "discountVolume": 5, "discountPrice": 22 },
                "Afnan Supremacy Gala": { "basePrice": 28, "discountVolume": 5, "discountPrice": 25 },
                "Afnan Supremacy in Oud": { "basePrice": 25, "discountVolume": 5, "discountPrice": 23 },
                "Afnan Supremacy Incense": { "basePrice": 16, "discountVolume": 5, "discountPrice": 15 },
                "Afnan Supremacy Not Only Intense": { "basePrice": 27, "discountVolume": 5, "discountPrice": 26 },
                "Afnan Supremacy Silver": { "basePrice": 25, "discountVolume": 10, "discountPrice": 22 },
                "Afnan Supremacy in Heaven": { "basePrice": 23, "discountVolume": 10, "discountPrice": 22 },
                "Afnan Tobacco Rush": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Al Haramain Amber Oud Aqua Dubai": { "basePrice": 32, "discountVolume": 5, "discountPrice": 28 },
                "Al Haramain Amber Oud Dubai Night": { "basePrice": 32, "discountVolume": 5, "discountPrice": 29 },
                "Al Haramain Amber Oud Gold Edition Extreme": { "basePrice": 32, "discountVolume": 5, "discountPrice": 30 },
                "Al Haramain Amber Oud Ruby Edition": { "basePrice": 30, "discountVolume": 5, "discountPrice": 25 },
                "Al Haramain Amber Oud Tobacco Edition": { "basePrice": 38, "discountVolume": 5, "discountPrice": 37 },
                "Al Haramain Detour Noir": { "basePrice": 14, "discountVolume": 10, "discountPrice": 13 },
                "Al Haramain Detour Noir Exclusif": { "basePrice": 20, "discountVolume": 5, "discountPrice": 17 },
                "Al Haramain L‚ÄôAventure": { "basePrice": 18, "discountVolume": 10, "discountPrice": 14 },
                "Al Haramain L‚ÄôAventure Intense": { "basePrice": 28, "discountVolume": 10, "discountPrice": 26 },
                "Al Haramain L‚ÄôAventure Fraiche": { "basePrice": 29, "discountVolume": 5, "discountPrice": 26 },
                "Alfred Dunhill Icon": { "basePrice": 34, "discountVolume": 5, "discountPrice": 32 },
                "Amouage Interlude Man": { "basePrice": 75, "discountVolume": 5, "discountPrice": 74 },
                "Antonio Banderas Blue Seduction Wave": { "basePrice": 12, "discountVolume": 10, "discountPrice": 11 },
                "Ard al Zaafaran Midnight Oud": { "basePrice": 21, "discountVolume": 5, "discountPrice": 20 },
                "Armaf Blue Homme": { "basePrice": 15, "discountVolume": 10, "discountPrice": 14 },
                "Armaf Club De Nuit Blue Iconic": { "basePrice": 23, "discountVolume": 5, "discountPrice": 20 },
                "Armaf Club De Nuit Intense Woman": { "basePrice": 17, "discountVolume": 5, "discountPrice": 15 },
                "Armaf Club De Nuit Sillage": { "basePrice": 20, "discountVolume": 10, "discountPrice": 19 },
                "Armaf Club De Nuit Urban Elixir": { "basePrice": 22, "discountVolume": 5, "discountPrice": 20 },
                "Armaf Club De Nuit Woman": { "basePrice": 16, "discountVolume": 5, "discountPrice": 15 },
                "Armaf Club de Nuit Intense Man EDT": { "basePrice": 18, "discountVolume": 5, "discountPrice": 16 },
                "Armaf Club de Nuit Intense Man Parfum": { "basePrice": 25, "discountVolume": 5, "discountPrice": 23 },
                "Armaf Club de Nuit Milestone": { "basePrice": 18, "discountVolume": 5, "discountPrice": 16 },
                "Arte Olfatto Black Hashish": { "basePrice": 55, "discountVolume": 5, "discountPrice": 52 },
                "Attar Collection Musk Kashmir": { "basePrice": 44, "discountVolume": 5, "discountPrice": 42 },
                "Azzaro Chrome": { "basePrice": 22, "discountVolume": 10, "discountPrice": 20 },
                "Azzaro Chrome Legend": { "basePrice": 14, "discountVolume": 10, "discountPrice": 13 },
                "Azzaro Chrome Parfum": { "basePrice": 25, "discountVolume": 10, "discountPrice": 23 },
                "Azzaro Forever Wanted Elixir": { "basePrice": 58, "discountVolume": 5, "discountPrice": 55 },
                "Azzaro The Most Wanted": { "basePrice": 43, "discountVolume": 5, "discountPrice": 40 },
                "Azzaro The Most Wanted Intense EDT": { "basePrice": 33, "discountVolume": 5, "discountPrice": 32 },
                "Azzaro The Most Wanted Parfum": { "basePrice": 45, "discountVolume": 10, "discountPrice": 44 },
                "Azzaro Wanted EDP": { "basePrice": 32, "discountVolume": 10, "discountPrice": 30 },
                "Azzaro Wanted by Night": { "basePrice": 40, "discountVolume": 5, "discountPrice": 37 },
                "Bentley Intense for Men": { "basePrice": 15, "discountVolume": 10, "discountPrice": 13 },
                "Bois 1920 Cannabis Fruttata": { "basePrice": 58, "discountVolume": 5, "discountPrice": 55 },
                "Bois 1920 Parana": { "basePrice": 60, "discountVolume": 5, "discountPrice": 55 },
                "Burberry Her Elixir": { "basePrice": 50, "discountVolume": 5, "discountPrice": 49 },
                "Burberry Hero Parfum": { "basePrice": 41, "discountVolume": 5, "discountPrice": 39 },
                "Burberry Hero Parfum Intense": { "basePrice": 47, "discountVolume": 5, "discountPrice": 45 },
                "Burberry London For Men": { "basePrice": 19, "discountVolume": 5, "discountPrice": 17 },
                "Bvlgari Aqva Pour Homme": { "basePrice": 47, "discountVolume": 5, "discountPrice": 45 },
                "Bvlgari Le Gemme Orom": { "basePrice": 155, "discountVolume": 5, "discountPrice": 150 },
                "Bvlgari Man In Black": { "basePrice": 42, "discountVolume": 10, "discountPrice": 40 },
                "Bvlgari Man In Black Parfum": { "basePrice": 54, "discountVolume": 5, "discountPrice": 49 },
                "Bvlgari Man Terrae Essence": { "basePrice": 44, "discountVolume": 5, "discountPrice": 42 },
                "Bvlgari Man Wood Neroli": { "basePrice": 40, "discountVolume": 5, "discountPrice": 35 },
                "Bvlgari Omnia Coral": { "basePrice": 52, "discountVolume": 5, "discountPrice": 50 },
                "Bvlgari Omnia Crystalline": { "basePrice": 52, "discountVolume": 5, "discountPrice": 48 },
                "Bvlgari Pour Homme EDP": { "basePrice": 45, "discountVolume": 5, "discountPrice": 43 },
                "By Kilian Angels Share": { "basePrice": 135, "discountVolume": 5, "discountPrice": 130 },
                "By Kilian Old Fashioned": { "basePrice": 130, "discountVolume": 5, "discountPrice": 125 },
                "Cacharel Noa": { "basePrice": 24, "discountVolume": 5, "discountPrice": 20 },
                "Carolina Herrera 212 Men": { "basePrice": 30, "discountVolume": 5, "discountPrice": 29 },
                "Carolina Herrera 212 NYC": { "basePrice": 38, "discountVolume": 5, "discountPrice": 36 },
                "Carolina Herrera 212 VIP Black Elixir": { "basePrice": 50, "discountVolume": 5, "discountPrice": 48 },
                "Carolina Herrera Bad Boy Cobalt Elixir": { "basePrice": 49, "discountVolume": 10, "discountPrice": 45 },
                "Carolina Herrera Bad Boy Elixir": { "basePrice": 55, "discountVolume": 10, "discountPrice": 50 },
                "Carolina Herrera Bad Boy Extreme": { "basePrice": 49, "discountVolume": 5, "discountPrice": 45 },
                "Carolina Herrera Bad Boy Le Parfum": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Carolina Herrera CH Men Pasion": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Carolina Herrera CH Men Prive": { "basePrice": 55, "discountVolume": 10, "discountPrice": 50 },
                "Carolina Herrera Chic For Men": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Carolina Herrera Good Girl": { "basePrice": 40, "discountVolume": 5, "discountPrice": 37 },
                // --- –ß–∞—Å—Ç–∏–Ω–∞ 2 ---
                "Carolina Herrera Good Girl Supreme": { "basePrice": 55, "discountVolume": 5, "discountPrice": 50 },
                "Cartier Declaration": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Cartier Declaration Haute Fraicheur": { "basePrice": 33, "discountVolume": 10, "discountPrice": 30 },
                "Chanel Allure Homme Edition Blanche": { "basePrice": 64, "discountVolume": 5, "discountPrice": 60 },
                "Chanel Allure Homme Sport": { "basePrice": 55, "discountVolume": 5, "discountPrice": 50 },
                "Chanel Allure Homme Sport Cologne": { "basePrice": 55, "discountVolume": 5, "discountPrice": 50 },
                "Chanel Bleu de Chanel": { "basePrice": 50, "discountVolume": 5, "discountPrice": 47 },
                "Chanel Egoiste": { "basePrice": 60, "discountVolume": 5, "discountPrice": 55 },
                "Chanel Egoiste Platinum": { "basePrice": 60, "discountVolume": 5, "discountPrice": 55 },
                "Chloe Eau de Parfum": { "basePrice": 35, "discountVolume": 5, "discountPrice": 32 },
                "Chopard Black Incense Malaki": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Chopard Cedar Malaki": { "basePrice": 39, "discountVolume": 5, "discountPrice": 36 },
                "Dior Homme 2020": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Dior Homme Cologne 2022": { "basePrice": 44, "discountVolume": 10, "discountPrice": 37 },
                "Dior Homme Intense 2011": { "basePrice": 55, "discountVolume": 5, "discountPrice": 53 },
                "Dior Homme Parfum 2025": { "basePrice": 90, "discountVolume": 5, "discountPrice": 85 },
                "Christian Dior Eau Sauvage Parfum": { "basePrice": 65, "discountVolume": 5, "discountPrice": 62 },
                "Christian Dior Fahrenheit": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Christian Dior Fahrenheit Le Parfum": { "basePrice": 68, "discountVolume": 5, "discountPrice": 63 },
                "Christian Dior Homme Sport 2021": { "basePrice": 38, "discountVolume": 5, "discountPrice": 37 },
                "Christian Dior Hypnotic Poison": { "basePrice": 52, "discountVolume": 5, "discountPrice": 48 },
                "Christian Dior J'Adore EDT": { "basePrice": 47, "discountVolume": 5, "discountPrice": 46 },
                "Christian Dior J'Adore Infinissime": { "basePrice": 46, "discountVolume": 5, "discountPrice": 45 },
                "Christian Dior Miss Dior Essence": { "basePrice": 75, "discountVolume": 5, "discountPrice": 73 },
                "Christian Dior Miss Dior Rose N‚ÄôRoses": { "basePrice": 44, "discountVolume": 5, "discountPrice": 42 },
                "Christian Dior Sauvage 2015": { "basePrice": 39, "discountVolume": 5, "discountPrice": 35 },
                "Christian Dior Sauvage EDP 2018": { "basePrice": 47, "discountVolume": 5, "discountPrice": 45 },
                "Christian Dior Sauvage Elixir": { "basePrice": 99, "discountVolume": 5, "discountPrice": 95 },
                "Clinique Happy for Men": { "basePrice": 24, "discountVolume": 10, "discountPrice": 22 },
                "Coach Green": { "basePrice": 20, "discountVolume": 10, "discountPrice": 18 },
                "Creed Millesime Imperial": { "basePrice": 67, "discountVolume": 5, "discountPrice": 65 },
                "D&G L‚ÄôImperatrice": { "basePrice": 24, "discountVolume": 5, "discountPrice": 23 },
                "D&G Light Blue Italian Love": { "basePrice": 35, "discountVolume": 5, "discountPrice": 33 },
                "D&G Light Blue Pour Femme": { "basePrice": 27, "discountVolume": 5, "discountPrice": 25 },
                "D&G Light Blue Summer Vibes": { "basePrice": 35, "discountVolume": 10, "discountPrice": 32 },
                "D&G Light Blue Summer Vibes PH": { "basePrice": 29, "discountVolume": 10, "discountPrice": 28 },
                "D&G The One EDP": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "D&G The One for Men EDT": { "basePrice": 29, "discountVolume": 5, "discountPrice": 27 },
                "D&G The One for Men EDP": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
                "Escentric Molecules Escentric 03": { "basePrice": 38, "discountVolume": 5, "discountPrice": 36 },
                "Escentric Molecules Escentric 04": { "basePrice": 43, "discountVolume": 5, "discountPrice": 40 },
                "Escentric Molecules Molecule 05": { "basePrice": 35, "discountVolume": 5, "discountPrice": 30 },
                "Essential Parfums Bois Imperial Extrait": { "basePrice": 220, "discountVolume": 5, "discountPrice": 219 },
                "Ex Nihilo Outcast Blue Extrait": { "basePrice": 163, "discountVolume": 5, "discountPrice": 160 },
                "Fragrance World French Avenue Liquid Brun": { "basePrice": 27, "discountVolume": 5, "discountPrice": 25 },
                "Franck Boclet Patchouli": { "basePrice": 38, "discountVolume": 5, "discountPrice": 36 },
                "Franck Boclet Tobacco": { "basePrice": 38, "discountVolume": 5, "discountPrice": 36 },
                "Armani Acqua Di Gio Parfum": { "basePrice": 34, "discountVolume": 5, "discountPrice": 30 },
                "Armani Acqua di Gio EDT": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
                "Armani Acqua di Gio Absolu": { "basePrice": 40, "discountVolume": 10, "discountPrice": 39 },
                "Armani Acqua di Gio EDP": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Armani Acqua di Gio Pour Homme": { "basePrice": 29, "discountVolume": 5, "discountPrice": 25 },
                "Armani Acqua di Gio Pour Homme 2024": { "basePrice": 32, "discountVolume": 5, "discountPrice": 30 },
                "Armani Acqua di Gio Profondo": { "basePrice": 32, "discountVolume": 10, "discountPrice": 28 },
                "Armani Acqua di Gio Profondo Parfum": { "basePrice": 45, "discountVolume": 5, "discountPrice": 43 },
                "Armani Acqua di Gioia": { "basePrice": 45, "discountVolume": 5, "discountPrice": 42 },
                "Armani Acqua di Gioia Intense": { "basePrice": 48, "discountVolume": 5, "discountPrice": 45 },
                "Armani Code Parfum": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Armani Eau de Nuit": { "basePrice": 43, "discountVolume": 5, "discountPrice": 42 },
                "Armani Because It‚Äôs You": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Armani Stronger With You": { "basePrice": 36, "discountVolume": 5, "discountPrice": 34 },
                "Armani Stronger With You Absolutely": { "basePrice": 43, "discountVolume": 5, "discountPrice": 40 },
                "Armani Stronger With You Intensely": { "basePrice": 40, "discountVolume": 5, "discountPrice": 36 },
                "Armani Stronger With You Leather": { "basePrice": 50, "discountVolume": 5, "discountPrice": 49 },
                "Armani Stronger With You Oud": { "basePrice": 48, "discountVolume": 5, "discountPrice": 47 },
                "Armani Stronger With You Parfum": { "basePrice": 57, "discountVolume": 5, "discountPrice": 55 },
                "Armani Stronger With You Tobacco": { "basePrice": 42, "discountVolume": 5, "discountPrice": 39 },
                "Armani My Way": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Armani My Way Parfum": { "basePrice": 50, "discountVolume": 5, "discountPrice": 48 },
                "Armani Si": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Armani Si Passione Intense": { "basePrice": 45, "discountVolume": 5, "discountPrice": 44 },
                "Givenchy Ange ou Demon": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Givenchy Ange ou Demon Le Secret": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Givenchy Gentleman Boisee EDP": { "basePrice": 30, "discountVolume": 5, "discountPrice": 28 },
                "Givenchy Gentleman EDP": { "basePrice": 35, "discountVolume": 0, "discountPrice": 35 }, // –ë–µ–∑ –º—ñ–Ω—ñ–º–∞–ª–∫–∏, discountVolume: 0
                "Givenchy Gentleman Intense": { "basePrice": 30, "discountVolume": 5, "discountPrice": 29 },
                "Givenchy Gentleman Original": { "basePrice": 34, "discountVolume": 5, "discountPrice": 30 },
                "Givenchy Gentleman Reserve Privee": { "basePrice": 35, "discountVolume": 5, "discountPrice": 33 },
                "Givenchy Gentleman Society Ambree": { "basePrice": 49, "discountVolume": 5, "discountPrice": 45 },
                "Givenchy Gentleman Society Extreme": { "basePrice": 43, "discountVolume": 5, "discountPrice": 41 },
                "Givenchy L‚ÄôInterdit Intense": { "basePrice": 47, "discountVolume": 5, "discountPrice": 45 },
                "Givenchy L‚ÄôInterdit EDT": { "basePrice": 41, "discountVolume": 5, "discountPrice": 40 },
                "Givenchy Pour Homme": { "basePrice": 25, "discountVolume": 5, "discountPrice": 22 },
                "Givenchy Pour Homme Blue Label": { "basePrice": 25, "discountVolume": 5, "discountPrice": 23 },
                "Givenchy Very Irresistible": { "basePrice": 44, "discountVolume": 5, "discountPrice": 42 },
                "Gucci Bloom": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
                // --- –ß–∞—Å—Ç–∏–Ω–∞ 3 (–ù–æ–≤–∏–π –ø–∞–∫–µ—Ç) ---
                "Gucci Bloom Profumo di Fiori": { "basePrice": 41, "discountVolume": 5, "discountPrice": 40 },
                "Gucci Guilty Intense Pour Femme": { "basePrice": 54, "discountVolume": 5, "discountPrice": 50 },
                "Gucci Guilty Elixir pour Homme": { "basePrice": 89, "discountVolume": 5, "discountPrice": 85 },
                "Gucci Guilty Essence pour Homme": { "basePrice": 39, "discountVolume": 10, "discountPrice": 36 },
                "Gucci Guilty Pour Femme Absolute": { "basePrice": 50, "discountVolume": 5, "discountPrice": 46 },
                "Gucci Guilty Pour Femme EDT": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Gucci Guilty Pour Homme Absolute": { "basePrice": 29, "discountVolume": 5, "discountPrice": 27 },
                "Gucci Intense Oud": { "basePrice": 45, "discountVolume": 5, "discountPrice": 43 },
                "Gucci Rush": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Guerlain L‚ÄôHomme Ideal": { "basePrice": 33, "discountVolume": 5, "discountPrice": 30 },
                "Guerlain La Petite Robe Noire": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Guerlain La Petite Robe Noire Absolue": { "basePrice": 42, "discountVolume": 5, "discountPrice": 38 },
                "Hermes H24 EDP": { "basePrice": 33, "discountVolume": 5, "discountPrice": 30 },
                "Hermes H24 EDT": { "basePrice": 28, "discountVolume": 5, "discountPrice": 26 },
                "Hermes H24 Herbes Vives": { "basePrice": 43, "discountVolume": 10, "discountPrice": 40 },
                "Hermes Jour d‚ÄôHermes": { "basePrice": 48, "discountVolume": 5, "discountPrice": 44 },
                "Hermes Jour d‚ÄôHermes Absolu": { "basePrice": 60, "discountVolume": 5, "discountPrice": 57 },
                "Hermes Terre d‚ÄôHermes EDT": { "basePrice": 34, "discountVolume": 5, "discountPrice": 32 },
                "Hermes Terre d‚ÄôHermes Parfum": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Hermes Terre d‚ÄôHermes Eau Givree": { "basePrice": 39, "discountVolume": 5, "discountPrice": 38 },
                "Hermes Terre d‚ÄôHermes Intense Vetiver": { "basePrice": 35, "discountVolume": 5, "discountPrice": 34 },
                "Hermes Terre d‚ÄôHermes Flacon H 2019": { "basePrice": 65, "discountVolume": 5, "discountPrice": 60 },
                "Hermes Terre d‚ÄôHermes Intense": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Hermes Un Jardin sur le Nil": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Hermes Voyage d‚ÄôHermes Parfum": { "basePrice": 50, "discountVolume": 5, "discountPrice": 48 },
                "Histoires de Parfums 1725 Casanova": { "basePrice": 30, "discountVolume": 5, "discountPrice": 29 },
                "Histoires de Parfums 1740 Marquis de Sade": { "basePrice": 44, "discountVolume": 5, "discountPrice": 42 },
                "Histoires de Parfums 1899 Hemingway": { "basePrice": 40, "discountVolume": 5, "discountPrice": 37 },
                "Histoires de Parfums Ambre 114": { "basePrice": 40, "discountVolume": 5, "discountPrice": 37 },
                "Hugo Boss Bottled Absolu": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Hugo Boss Bottled Elixir": { "basePrice": 49, "discountVolume": 5, "discountPrice": 46 },
                "Hugo Boss Bottled Triumph Elixir": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Hugo Boss The Scent Elixir": { "basePrice": 43, "discountVolume": 5, "discountPrice": 39 },
                "Hugo Boss The Scent Le Parfum": { "basePrice": 38, "discountVolume": 5, "discountPrice": 37 },
                "Hugo Boss The Scent for Him": { "basePrice": 23, "discountVolume": 5, "discountPrice": 20 },
                "Issey Miyake L‚ÄôEau Bleue d‚ÄôIssey": { "basePrice": 32, "discountVolume": 5, "discountPrice": 28 },
                "Issey Miyake Wood & Wood": { "basePrice": 28, "discountVolume": 5, "discountPrice": 27 },
                "Issey Miyake Le Sel d‚ÄôIssey": { "basePrice": 33, "discountVolume": 5, "discountPrice": 32 },
                "Jean Paul Gaultier Divine Elixir": { "basePrice": 54, "discountVolume": 5, "discountPrice": 50 },
                "Jean Paul Gaultier Le Beau": { "basePrice": 43, "discountVolume": 5, "discountPrice": 41 },
                "Jean Paul Gaultier Le Beau Le Parfum": { "basePrice": 55, "discountVolume": 5, "discountPrice": 53 },
                "Jean Paul Gaultier Le Beau Paradise Garden": { "basePrice": 46, "discountVolume": 5, "discountPrice": 44 },
                "Jean Paul Gaultier Le Male": { "basePrice": 32, "discountVolume": 5, "discountPrice": 28 },
                "Jean Paul Gaultier Le Male Elixir": { "basePrice": 45, "discountVolume": 5, "discountPrice": 39 },
                "Jean Paul Gaultier Le Male Elixir Absolu": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Jean Paul Gaultier Le Male Le Parfum": { "basePrice": 39, "discountVolume": 5, "discountPrice": 36 },
                "Jean Paul Gaultier Scandal": { "basePrice": 49, "discountVolume": 5, "discountPrice": 47 },
                "Jean Paul Gaultier Scandal Absolu": { "basePrice": 58, "discountVolume": 5, "discountPrice": 53 },
                "Jean Paul Gaultier Scandal Pour Homme": { "basePrice": 32, "discountVolume": 5, "discountPrice": 30 },
                "Jean Paul Gaultier Scandal Pour Homme Absolu": { "basePrice": 49, "discountVolume": 5, "discountPrice": 45 },
                "Jean Paul Gaultier Scandal Pour Homme Le Parfum": { "basePrice": 44, "discountVolume": 5, "discountPrice": 40 },
                "Jean Paul Gaultier Ultra Male": { "basePrice": 37, "discountVolume": 5, "discountPrice": 34 },
                "John Varvatos Artisan": { "basePrice": 19, "discountVolume": 5, "discountPrice": 17 },
                "John Varvatos Artisan Pure": { "basePrice": 25, "discountVolume": 10, "discountPrice": 24 },
                "John Varvatos For Men": { "basePrice": 20, "discountVolume": 5, "discountPrice": 19 },
                "John Varvatos XX Artisan Teal": { "basePrice": 24, "discountVolume": 10, "discountPrice": 23 },
                "Juliette Has A Gun Ex Vetiver": { "basePrice": 48, "discountVolume": 5, "discountPrice": 45 },
                "Kenzo Homme 2022": { "basePrice": 35, "discountVolume": 10, "discountPrice": 29 },
                "Kenzo Santal Marin": { "basePrice": 36, "discountVolume": 5, "discountPrice": 35 },
                "Kenzo L‚ÄôEau Kenzo pour Homme": { "basePrice": 24, "discountVolume": 5, "discountPrice": 21 },
                "Lacoste Pour Femme": { "basePrice": 30, "discountVolume": 5, "discountPrice": 26 },
                "Lalique Encre Indigo": { "basePrice": 24, "discountVolume": 5, "discountPrice": 21 },
                "Lalique Encre Noire": { "basePrice": 14, "discountVolume": 10, "discountPrice": 12 },
                "Lalique Encre Noire Sport": { "basePrice": 14, "discountVolume": 10, "discountPrice": 13 },
                "Lalique Encre Noire √† L‚ÄôExtreme": { "basePrice": 16, "discountVolume": 10, "discountPrice": 14 },
                "Lalique Ombre Noire": { "basePrice": 37, "discountVolume": 5, "discountPrice": 34 },
                "Lancome La Vie Est Belle": { "basePrice": 38, "discountVolume": 5, "discountPrice": 35 },
                "Lancome La Vie Est Belle L‚ÄôElixir": { "basePrice": 49, "discountVolume": 5, "discountPrice": 46 },
                "Lancome Miracle": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Lancome Tresor": { "basePrice": 39, "discountVolume": 5, "discountPrice": 37 },
                "Lattafa Asad": { "basePrice": 15, "discountVolume": 10, "discountPrice": 14 },
                "Lattafa Asad Bourbon": { "basePrice": 20, "discountVolume": 5, "discountPrice": 18 },
                "Lattafa Asad Zanzibar": { "basePrice": 14, "discountVolume": 10, "discountPrice": 13 },
                "Lattafa Badee Al Oud Oud for Glory": { "basePrice": 16, "discountVolume": 10, "discountPrice": 15 },
                "Lattafa Fakhar Extrait": { "basePrice": 18, "discountVolume": 5, "discountPrice": 17 },
                "Lattafa Fakhar Platin": { "basePrice": 25, "discountVolume": 5, "discountPrice": 22 },
                "Lattafa Fakhar for Men": { "basePrice": 18, "discountVolume": 10, "discountPrice": 17 },
                "Lattafa Khamrah": { "basePrice": 22, "discountVolume": 5, "discountPrice": 20 },
                "Lattafa Khamrah Dukhan": { "basePrice": 25, "discountVolume": 5, "discountPrice": 24 },
                "Lattafa Khamrah Qahwa": { "basePrice": 20, "discountVolume": 10, "discountPrice": 17 },
                "Lattafa Musamam White Intense": { "basePrice": 28, "discountVolume": 5, "discountPrice": 25 },
                "Lattafa Pride Masa": { "basePrice": 22, "discountVolume": 5, "discountPrice": 20 },
                "Lattafa Pride Vintage Radio": { "basePrice": 20, "discountVolume": 10, "discountPrice": 16 },
                "Lattafa Yara": { "basePrice": 15, "discountVolume": 5, "discountPrice": 13 },
                "Lattafa Yara Candy": { "basePrice": 20, "discountVolume": 5, "discountPrice": 17 },
                "Lattafa Yara Tous": { "basePrice": 16, "discountVolume": 5, "discountPrice": 15 },
                "Loewe Solo Loewe": { "basePrice": 45, "discountVolume": 10, "discountPrice": 40 },
                "Maison Margiela Replica Autumn Vibes": { "basePrice": 55, "discountVolume": 5, "discountPrice": 52 },
                "Maison Margiela Replica Beach Walk": { "basePrice": 45, "discountVolume": 5, "discountPrice": 43 },
                "Maison Margiela Replica By the Fireplace": { "basePrice": 55, "discountVolume": 5, "discountPrice": 50 },
                "Maison Margiela Replica Flying": { "basePrice": 50, "discountVolume": 5, "discountPrice": 45 },
                "Maison Margiela Replica Jazz Club": { "basePrice": 51, "discountVolume": 5, "discountPrice": 49 },
                "Maison Margiela Replica On A Date": { "basePrice": 55, "discountVolume": 5, "discountPrice": 50 },
                "Maison Margiela Replica Under the Stars": { "basePrice": 54, "discountVolume": 5, "discountPrice": 50 },
                "Mancera Amore Caffe": { "basePrice": 39, "discountVolume": 5, "discountPrice": 36 },
                // --- –ß–∞—Å—Ç–∏–Ω–∞ 4 (–ù–æ–≤–∏–π –ø–∞–∫–µ—Ç: Mancera - Prada) V8.11 ---
                "Mancera Cedrat Boise EDP": { "basePrice": 34, "discountVolume": 5, "discountPrice": 32 },
                "Mancera Cedrat Boise Intense Parfum": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Mancera Cosmic Pepper EDP": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Mancera Eternal Wood EDP": { "basePrice": 39, "discountVolume": 5, "discountPrice": 36 },
                "Mancera Red Tobacco EDP": { "basePrice": 38, "discountVolume": 5, "discountPrice": 36 },
                "Mancera Red Tobacco Intense EDP": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Mancera Roses Vanille EDP": { "basePrice": 32, "discountVolume": 5, "discountPrice": 29 },
                "Mancera Tonka Cola EDP": { "basePrice": 39, "discountVolume": 5, "discountPrice": 35 },
                "Mercedes-Benz Man Private EDP": { "basePrice": 30, "discountVolume": 5, "discountPrice": 29 },
                "Missoni Parfum Pour Homme EDP": { "basePrice": 20, "discountVolume": 5, "discountPrice": 18 },
                "Missoni Wave EDT": { "basePrice": 25, "discountVolume": 5, "discountPrice": 24 },
                "Montale Arabians Tonka EDP": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Montale Intense Cafe EDP": { "basePrice": 35, "discountVolume": 5, "discountPrice": 34 },
                "Montale Red Vetiver EDP": { "basePrice": 37, "discountVolume": 5, "discountPrice": 36 },
                "Montblanc Explorer EDP": { "basePrice": 23, "discountVolume": 5, "discountPrice": 20 },
                "Montblanc Explorer Extreme Parfum": { "basePrice": 40, "discountVolume": 5, "discountPrice": 36 },
                "Montblanc Explorer Platinum EDP": { "basePrice": 22, "discountVolume": 5, "discountPrice": 19 },
                "Moschino Toy 2 EDT": { "basePrice": 27, "discountVolume": 5, "discountPrice": 24 },
                "Moschino Toy 2 Bubble Gum EDT": { "basePrice": 26, "discountVolume": 5, "discountPrice": 25 },
                "Moschino Toy 2 Pearl EDP": { "basePrice": 35, "discountVolume": 5, "discountPrice": 30 },
                "Moschino Toy Boy EDP": { "basePrice": 28, "discountVolume": 5, "discountPrice": 26 },
                "Nasomatto Black Afgano Parfum": { "basePrice": 210, "discountVolume": 5, "discountPrice": 205 },
                "Nautica Voyage EDT": { "basePrice": 13, "discountVolume": 10, "discountPrice": 12 }, 
                "Nina Ricci Nina EDT": { "basePrice": 33, "discountVolume": 5, "discountPrice": 30 },
                "Nishane Hacivat X": { "basePrice": 83, "discountVolume": 5, "discountPrice": 80 },
                "Novellista Unique Wood EDP": { "basePrice": 40, "discountVolume": 5, "discountPrice": 38 },
                "Novellista Vanilla Club EDP": { "basePrice": 43, "discountVolume": 5, "discountPrice": 41 },
                "Olfactive Studio Autoportrait EDP": { "basePrice": 39, "discountVolume": 10, "discountPrice": 37 }, 
                "Orlov Paris Good Vibes EDP": { "basePrice": 62, "discountVolume": 5, "discountPrice": 60 },
                "Orto Parisi Bergamask Parfum": { "basePrice": 149, "discountVolume": 5, "discountPrice": 140 },
                "Paco Rabanne 1 Million EDT": { "basePrice": 30, "discountVolume": 5, "discountPrice": 27 },
                "Paco Rabanne 1 Million Elixir Parfum": { "basePrice": 45, "discountVolume": 5, "discountPrice": 44 },
                "Paco Rabanne 1 Million Parfum": { "basePrice": 38, "discountVolume": 5, "discountPrice": 35 },
                "Paco Rabanne Invictus Parfum": { "basePrice": 48, "discountVolume": 10, "discountPrice": 45 }, 
                "Paco Rabanne Invictus Victory EDP": { "basePrice": 34, "discountVolume": 5, "discountPrice": 32 },
                "Paco Rabanne Invictus Victory Absolu Parfum": { "basePrice": 50, "discountVolume": 5, "discountPrice": 47 },
                "Paco Rabanne Lady Million EDP": { "basePrice": 45, "discountVolume": 5, "discountPrice": 43 },
                "Paco Rabanne Lady Million Empire EDP": { "basePrice": 40, "discountVolume": 5, "discountPrice": 39 },
                "Paco Rabanne Million Gold EDP (102/200)": { "basePrice": 43, "discountVolume": 5, "discountPrice": 39 },
                "Paco Rabanne Million Gold EDP (67/200)": { "basePrice": 45, "discountVolume": 5, "discountPrice": 39 },
                "Paco Rabanne Million Gold Elixir Parfum": { "basePrice": 55, "discountVolume": 10, "discountPrice": 50 }, 
                "Paco Rabanne Olympea EDP": { "basePrice": 45, "discountVolume": 5, "discountPrice": 40 },
                "Paco Rabanne Phantom EDT": { "basePrice": 33, "discountVolume": 5, "discountPrice": 29 },
                "Perry Ellis 360¬∞ Red for Men EDT": { "basePrice": 17, "discountVolume": 5, "discountPrice": 16 },
                "Philipp Plein No Limit$ EDP": { "basePrice": 24, "discountVolume": 5, "discountPrice": 22 },
                "Philipp Plein No Limits Gold EDP": { "basePrice": 25, "discountVolume": 5, "discountPrice": 24 },
                "Prada L‚ÄôHomme EDT": { "basePrice": 43, "discountVolume": 5, "discountPrice": 40 },
                "Prada Luna Rossa EDT": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
                "Prada Luna Rossa Black EDP": { "basePrice": 46, "discountVolume": 5, "discountPrice": 44 },
                "Prada Luna Rossa Carbon EDT": { "basePrice": 42, "discountVolume": 5, "discountPrice": 40 },
                "Prada Luna Rossa Ocean EDT": { "basePrice": 43, "discountVolume": 5, "discountPrice": 40 },
                "Prada Luna Rossa Ocean Le Parfum": { "basePrice": 50, "discountVolume": 10, "discountPrice": 48 }, 
                "Prada Luna Rossa Sport EDT": { "basePrice": 37, "discountVolume": 5, "discountPrice": 35 },
// ===================================================================
// ================== –û–ù–û–í–õ–ï–ù–ù–Ø –ü–†–ê–ô–°–£ –í–Ü–î –ö–û–†–ò–°–¢–£–í–ê–ß–ê ================
// ===================================================================
"Ralph Lauren Ralp‚Äôs Club Elixir": {basePrice: 50, discountVolume: 5, discountPrice: 48},
"Rasasi Entebaa pour Homme": {basePrice: 20, discountVolume: 5, discountPrice: 17},
"Rasasi Fattan Pour Homme": {basePrice: 20, discountVolume: 5, discountPrice: 19},
"Rasasi La Yuqawam Pour Homme": {basePrice: 45, discountVolume: 5, discountPrice: 43},
"Rasasi Qasamat Bareeq": {basePrice: 30, discountVolume: 5, discountPrice: 29},
"Rasasi Rumz Al Rasasi 9325 Pour Lui": {basePrice: 30, discountVolume: 10, discountPrice: 25},
"Rasasi Rumz Al Rasasi 9453 Pour Lui": {basePrice: 36, discountVolume: 5, discountPrice: 35},
"Rasasi Tobacco Blaze": {basePrice: 44, discountVolume: 10, discountPrice: 40},
"Reyane Tradition Insurrection II Wild": {basePrice: 25, discountVolume: 0, discountPrice: 25}, // –ë–µ–∑ –∑–Ω–∏–∂–∫–∏
"Rochas Man Intense": {basePrice: 17, discountVolume: 5, discountPrice: 16},
"Rochas Moustache Eau de Parfum": {basePrice: 19, discountVolume: 5, discountPrice: 17},
"Salvatore Ferragamo Uomo Signature": {basePrice: 25, discountVolume: 5, discountPrice: 24},
"Serge Lutens Ambre Sultan": {basePrice: 50, discountVolume: 5, discountPrice: 45},
"Serge Lutens Chergui": {basePrice: 59, discountVolume: 5, discountPrice: 53},
"Shiseido Zen 2007": {basePrice: 35, discountVolume: 5, discountPrice: 33},
"Swiss Arabian Intense Pride": {basePrice: 25, discountVolume: 10, discountPrice: 23},
"Thierry Mugler AMen": {basePrice: 42, discountVolume: 5, discountPrice: 40},
"Thierry Mugler AMen Fantasm": {basePrice: 40, discountVolume: 5, discountPrice: 35},
"Thierry Mugler Alien Goddess": {basePrice: 49, discountVolume: 5, discountPrice: 45},
"Thierry Mugler Angel EDT 2019": {basePrice: 44, discountVolume: 5, discountPrice: 40},
"Thierry Mugler Angel Stellar": {basePrice: 54, discountVolume: 5, discountPrice: 50},
"Tiziana Terenzi Kirke": {basePrice: 48, discountVolume: 5, discountPrice: 46},
"Tiziana Terenzi Kirke Overdose": {basePrice: 95, discountVolume: 5, discountPrice: 92},
"Tom Ford Eau d‚ÄôOmbre Leather": {basePrice: 74, discountVolume: 5, discountPrice: 68},
"Tom Ford Ombre Leather (2018)": {basePrice: 74, discountVolume: 5, discountPrice: 70},
"Tom Ford Oud Minerale 2023": {basePrice: 60, discountVolume: 5, discountPrice: 56},
"Trussardi Donna 2011": {basePrice: 23, discountVolume: 5, discountPrice: 21},
"Trussardi Donna EDT": {basePrice: 23, discountVolume: 5, discountPrice: 20},
"Trussardi My Land": {basePrice: 25, discountVolume: 5, discountPrice: 22},
"Valentino Uomo Born In Roma Intense": {basePrice: 60, discountVolume: 10, discountPrice: 55},
"Valentino Uomo Born in Roma": {basePrice: 48, discountVolume: 5, discountPrice: 46},
"Valentino Donna": {basePrice: 49, discountVolume: 5, discountPrice: 45},
"Valentino Uomo": {basePrice: 43, discountVolume: 5, discountPrice: 42},
"Valentino Uomo Acqua": {basePrice: 35, discountVolume: 5, discountPrice: 34},
"Valentino Uomo Intense": {basePrice: 59, discountVolume: 5, discountPrice: 55},
"Versace Bright Crystal": {basePrice: 25, discountVolume: 5, discountPrice: 23},
"Versace Bright Crystal Absolu": {basePrice: 29, discountVolume: 5, discountPrice: 27},
"Versace Bright Crystal Parfum": {basePrice: 42, discountVolume: 5, discountPrice: 39},
"Versace Crystal Noir": {basePrice: 33, discountVolume: 5, discountPrice: 30},
"Versace Crystal Noir Parfum": {basePrice: 52, discountVolume: 5, discountPrice: 48},
"Versace Eros": {basePrice: 23, discountVolume: 5, discountPrice: 20},
"Versace Eros EDP": {basePrice: 28, discountVolume: 5, discountPrice: 26},
"Versace Eros Energy": {basePrice: 40, discountVolume: 5, discountPrice: 38},
"Versace Eros Flame": {basePrice: 29, discountVolume: 5, discountPrice: 25},
"Versace Eros Najim": {basePrice: 50, discountVolume: 10, discountPrice: 48},
"Versace Eros Parfum": {basePrice: 40, discountVolume: 5, discountPrice: 37},
"Versace Eros Pour Femme": {basePrice: 32, discountVolume: 5, discountPrice: 30},
"Versace Eros Pour Femme EDT": {basePrice: 25, discountVolume: 5, discountPrice: 23},
"Versace Man Eau Fraiche": {basePrice: 24, discountVolume: 5, discountPrice: 20},
"Versace Pour Homme": {basePrice: 24, discountVolume: 5, discountPrice: 22},
"Versace Pour Homme Oud Noir": {basePrice: 38, discountVolume: 5, discountPrice: 36},
"Versace Versense": {basePrice: 30, discountVolume: 5, discountPrice: 29},
"Versace Yellow Diamond": {basePrice: 27, discountVolume: 5, discountPrice: 24},
"Viktor & Rolf Flowerbomb": {basePrice: 40, discountVolume: 5, discountPrice: 39},
"Viktor & Rolf Good Fortune": {basePrice: 28, discountVolume: 5, discountPrice: 26},
"Viktor & Rolf Spicebomb": {basePrice: 39, discountVolume: 5, discountPrice: 38},
"Viktor & Rolf Spicebomb Dark Leather": {basePrice: 38, discountVolume: 5, discountPrice: 35},
"Viktor & Rolf Spicebomb Extreme": {basePrice: 45, discountVolume: 5, discountPrice: 43},
"Viktor & Rolf Spicebomb Infrared": {basePrice: 43, discountVolume: 5, discountPrice: 41},
"Viktor & Rolf Spicebomb Night Vision": {basePrice: 38, discountVolume: 5, discountPrice: 36},
"Xerjoff Sospiro Afgano Puro": {basePrice: 75, discountVolume: 5, discountPrice: 73},
"YSL Black Opium": {basePrice: 45, discountVolume: 5, discountPrice: 43},
"YSL Black Opium Le Parfum": {basePrice: 55, discountVolume: 5, discountPrice: 50},
"YSL La Nuit de L‚ÄôHomme": {basePrice: 35, discountVolume: 5, discountPrice: 33},
"YSL La Nuit de L‚ÄôHomme EDP": {basePrice: 42, discountVolume: 10, discountPrice: 39},
"YSL Libre": {basePrice: 37, discountVolume: 5, discountPrice: 36},
"YSL MYSLF": {basePrice: 39, discountVolume: 5, discountPrice: 36},
"YSL MYSLF Le Parfum": {basePrice: 49, discountVolume: 5, discountPrice: 48},
"YSL Y L‚ÄôElixir": {basePrice: 60, discountVolume: 5, discountPrice: 56},
"YSL Y Le Parfum": {basePrice: 47, discountVolume: 5, discountPrice: 45},
"YSL Y EDP": {basePrice: 40, discountVolume: 5, discountPrice: 38},
"YSL Y EDP Intense": {basePrice: 47, discountVolume: 5, discountPrice: 45},
"Zadig & Voltaire Just Rock! for Him": {basePrice: 40, discountVolume: 0, discountPrice: 40}, // –ë–µ–∑ –∑–Ω–∏–∂–∫–∏
"Zadig & Voltaire This Is Really Her!": {basePrice: 33, discountVolume: 5, discountPrice: 30},
"Zadig & Voltaire This Is Her!": {basePrice: 38, discountVolume: 5, discountPrice: 37},
"Zadig & Voltaire This Is Her! Vibes of Freedom": {basePrice: 39, discountVolume: 5, discountPrice: 35},
"Zadig & Voltaire This Is Him!": {basePrice: 29, discountVolume: 5, discountPrice: 26},
"Zarkoperfume Pink Molecule": {basePrice: 39, discountVolume: 5, discountPrice: 37},
"Afnan 9pm Elixir": {basePrice: 30, discountVolume: 10, discountPrice: 28},
"Afnan Rare Reef": {basePrice: 25, discountVolume: 5, discountPrice: 20},
"Ard Al Zaafaran Saheb Intense": {basePrice: 28, discountVolume: 5, discountPrice: 27},
"Gucci Guilty Elixir de Parfum pour Femme": {basePrice: 75, discountVolume: 5, discountPrice: 69},
// ===================================================================
// =================== –ö–Ü–ù–ï–¶–¨ –ù–û–í–ò–• –ü–ê–†–§–£–ú–Ü–í =========================
// ===================================================================
        };
        const INITIAL_MARKUP_PRESETS = { 
            "–†–æ–∑–¥—Ä—ñ–±": 0.12,
            "–û–ø—Ç-1": 0.08,
            "VIP": 0.10
        };
        const INITIAL_SALES_SOURCES = ["OLX", "Instagram", "–†–µ—Ñ–µ—Ä–∞–ª", "–ú–∞–≥–∞–∑–∏–Ω"]; 
        
        // *******************************************************************
        // ******************** –ê–ö–¢–£–ê–õ–¨–ù–ò–ô –î–û–í–Ü–î–ù–ò–ö –í–ê–†–¢–û–°–¢–Ü –§–õ–ê–ö–û–ù–Ü–í **********
        // *******************************************************************
        const INITIAL_FLACON_VOLUMES = [5, 10, 15, 20, 30, 50, 60]; 
        const INITIAL_FLACON_COSTS = { 
            5: 25, 
            10: 27, 
            15: 30, 
            20: 40, 
            30: 50, 
            50: 70, 
            60: 70 
        };

        // *******************************************************************
        // ******************** –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á (–ó–ë–ï–†–Ü–ì–ê–ù–ù–Ø/–ó–í–Ü–¢) ***********
        // *******************************************************************
        
        function loadTransactions() {
            const json = localStorage.getItem(DB_NAME);
            return json ? JSON.parse(json) : [];
        }

        function saveTransactions(data) {
            localStorage.setItem(DB_NAME, JSON.stringify(data));
        }

        function loadExpenses() {
            const json = localStorage.getItem(EXPENSES_KEY);
            return json ? JSON.parse(json) : [];
        }

        function saveExpenses(data) {
            localStorage.setItem(EXPENSES_KEY, JSON.stringify(data));
        }

        function loadPerfumePrices() {
            const pricesJson = localStorage.getItem(PRICES_KEY);
            if (pricesJson) {
                 PERFUME_PRICES = JSON.parse(pricesJson);
            } else {
                 PERFUME_PRICES = INITIAL_PERFUME_PRICES; 
            }
        }

        function loadFlaconData() {
            const volumesJson = localStorage.getItem(VOLUMES_KEY);
            const costsJson = localStorage.getItem(FLACONS_KEY);
            FLACON_VOLUMES = volumesJson ? JSON.parse(volumesJson) : INITIAL_FLACON_VOLUMES;
            FLACON_COSTS = costsJson ? JSON.parse(costsJson) : INITIAL_FLACON_COSTS;
        }
        
        function loadMarkupPresets() {
            const presetsJson = localStorage.getItem(MARKUP_PRESETS_KEY);
            if (presetsJson) {
                 MARKUP_PRESETS = JSON.parse(presetsJson);
            } else {
                 MARKUP_PRESETS = INITIAL_MARKUP_PRESETS;
            }
        }
        
        function saveMarkupPresets() {
            localStorage.setItem(MARKUP_PRESETS_KEY, JSON.stringify(MARKUP_PRESETS));
        }
        
        function loadSalesSources() {
            const sourcesJson = localStorage.getItem(SALES_SOURCES_KEY);
            if (sourcesJson) {
                 SALES_SOURCES = JSON.parse(sourcesJson);
            } else {
                 SALES_SOURCES = INITIAL_SALES_SOURCES;
            }
        }
        
        function saveSalesSources() {
            localStorage.setItem(SALES_SOURCES_KEY, JSON.stringify(SALES_SOURCES));
        }

        function savePerfumePrices() {
            localStorage.setItem(PRICES_KEY, JSON.stringify(PERFUME_PRICES));
        }

        function saveFlaconData() {
            localStorage.setItem(VOLUMES_KEY, JSON.stringify(FLACON_VOLUMES));
            localStorage.setItem(FLACONS_KEY, JSON.stringify(FLACON_COSTS));
        }

        function getMarkupFactor(presetName) {
            const markup = MARKUP_PRESETS[presetName] || 0; 
            return 1 + markup; 
        }

        function getActualCostPrice(perfumeName, volume) {
            const data = PERFUME_PRICES[perfumeName];
            if (!data) return null;
            if (volume >= data.discountVolume && data.discountVolume > 0) {
                return data.discountPrice;
            }
            return data.basePrice;
        }

        function getBaseCostPrice(perfumeName) {
            const data = PERFUME_PRICES[perfumeName];
            return data ? data.basePrice : null;
        }
        
        function calculateFixedSalePrice(baseCostPrice, markupName) {
            const factor = getMarkupFactor(markupName);
            return baseCostPrice * factor;
        }

        function saveInitialDataToLocalStorage() {
            if (!confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ? –¶—è –¥—ñ—è –°–ö–ò–ù–ï –í–°–Ü –î–û–í–Ü–î–ù–ò–ö–ò (–ø–∞—Ä—Ñ—É–º–∏, —Ñ–ª–∞–∫–æ–Ω–∏, –Ω–∞—Ü—ñ–Ω–∫–∏, –¥–∂–µ—Ä–µ–ª–∞) –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É. –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó —Ç–∞ –≤–∏—Ç—Ä–∞—Ç–∏ –ù–ï –ë–£–î–£–¢–¨ –∑–º—ñ–Ω–µ–Ω—ñ.")) {
                return;
            }
            localStorage.setItem(PRICES_KEY, JSON.stringify(INITIAL_PERFUME_PRICES));
            localStorage.setItem(VOLUMES_KEY, JSON.stringify(INITIAL_FLACON_VOLUMES));
            localStorage.setItem(FLACONS_KEY, JSON.stringify(INITIAL_FLACON_COSTS));
            localStorage.setItem(MARKUP_PRESETS_KEY, JSON.stringify(INITIAL_MARKUP_PRESETS)); 
            localStorage.setItem(SALES_SOURCES_KEY, JSON.stringify(INITIAL_SALES_SOURCES)); 

            loadPerfumePrices();
            loadFlaconData();
            loadMarkupPresets(); 
            loadSalesSources(); 
            
            populateFormOptions();
            renderPerfumeList();
            renderFlaconList();
            renderMarkupPresets(); 
            renderSalesSources(); 

            alert('‚úÖ –°—Ç–∞—Ä—Ç–æ–≤—ñ –¥–∞–Ω—ñ –¥–æ–≤—ñ–¥–Ω–∏–∫—ñ–≤ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ.');
        }
        
        // --- –§–£–ù–ö–¶–Ü–Ø –ù–ê–í–Ü–ì–ê–¶–Ü–á ---
        function showSection(sectionId, element) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.navbar a').forEach(link => {
                link.classList.remove('active');
            });
            if (element) {
                element.classList.add('active');
            }
            
            if (sectionId === 'report') {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('endDate').value = today;
                
                const firstDayOfMonth = new Date();
                firstDayOfMonth.setDate(1);
                document.getElementById('startDate').value = firstDayOfMonth.toISOString().split('T')[0];
                
                generateReport();
            }
            if (sectionId === 'transactions') {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('historyEndDate').value = today;
                const firstDayOfMonth = new Date();
                firstDayOfMonth.setDate(1);
                document.getElementById('historyStartDate').value = firstDayOfMonth.toISOString().split('T')[0];
                renderTransactionHistory();
            }
             if (sectionId === 'client-crm') { // –ù–û–í–ï: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è CRM
                 updateClientDatalist();
                 document.getElementById('clientCrmSummary').innerHTML = '';
                 document.getElementById('client-history-table').getElementsByTagName('tbody')[0].innerHTML = '';
             }
            if (sectionId === 'admin-panel') {
                renderPerfumeList();
                renderMarkupPresets(); 
                renderSalesSources(); 
            }
        }


        // *******************************************************************
        // *********************** –§–£–ù–ö–¶–Ü–á –î–õ–Ø –§–û–†–ú ****************************
        // *******************************************************************

        // --- 2. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Å–ø–∏—Å–∫—ñ–≤ –≤–∏–±–æ—Ä—É (–û–ù–û–í–õ–ï–ù–û) ---
        function populateFormOptions() {
            const selectIds = ['flaconVolume', 'orderFlaconVolume', 'calcFlaconVolume'];
            const sortedVolumes = FLACON_VOLUMES.sort((a, b) => a - b);
            
            selectIds.forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '';
                    
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = '–û–±–µ—Ä—ñ—Ç—å –æ–±‚Äô—î–º (–º–ª)';
                    defaultOption.disabled = true;
                    defaultOption.selected = true;
                    select.appendChild(defaultOption);
                    
                    sortedVolumes.forEach(volume => {
                        const option = document.createElement('option');
                        option.value = volume;
                        option.textContent = `${volume} –º–ª (–§–ª–∞–∫–æ–Ω: ${FLACON_COSTS[volume] || 0} –≥—Ä–Ω)`;
                        select.appendChild(option);
                    });

                    if (currentValue && sortedVolumes.includes(parseInt(currentValue))) {
                         select.value = currentValue;
                    }
                }
            });

            // –ù–∞—Ü—ñ–Ω–∫–∏
            const markupSelectIds = ['saleMarkupTierSingle', 'saleMarkupTierOrder', 'calcMarkupTier', 'historyFilterMarkup'];
            markupSelectIds.forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '';
                    
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = id.includes('Filter') ? '–£—Å—ñ –ù–∞—Ü—ñ–Ω–∫–∏' : '–û–±–µ—Ä—ñ—Ç—å –ù–∞—Ü—ñ–Ω–∫—É';
                    defaultOption.disabled = id.includes('Filter') ? false : true;
                    defaultOption.selected = true;
                    select.appendChild(defaultOption);
                    
                    Object.keys(MARKUP_PRESETS).sort().forEach(name => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = `${name} (${(MARKUP_PRESETS[name] * 100).toFixed(0)}%)`;
                        select.appendChild(option);
                    });
                    select.value = currentValue || Object.keys(MARKUP_PRESETS)[0]; 

                }
            });
            
            // –î–∂–µ—Ä–µ–ª–∞ –ü—Ä–æ–¥–∞–∂—É
            const sourceSelectIds = ['saleSourceSingle', 'saleSourceOrder', 'historyFilterSource'];
            sourceSelectIds.forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '';
                    
                    const defaultOption = document.createElement('option');
                    defaultOption.value = id.includes('Filter') ? '' : '---';
                    defaultOption.textContent = id.includes('Filter') ? '–£—Å—ñ –î–∂–µ—Ä–µ–ª–∞' : '–ù–µ –≤–∫–∞–∑–∞–Ω–æ';
                    defaultOption.selected = true;
                    select.appendChild(defaultOption);
                    
                    SALES_SOURCES.sort().forEach(name => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = name;
                        select.appendChild(option);
                    });
                    
                    if (currentValue && (SALES_SOURCES.includes(currentValue) || currentValue === '---')) {
                         select.value = currentValue;
                    }
                }
            });
            
            const datalist = document.getElementById('perfumeList');
            datalist.innerHTML = '';
            Object.keys(PERFUME_PRICES).sort().forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                datalist.appendChild(option);
            });
            
            updateClientDatalist(); // –û–ù–û–í–õ–ï–ù–û: –í–∏–∫–ª–∏–∫ –¥–ª—è —Å–ø–∏—Å–∫—É –∫–ª—ñ—î–Ω—Ç—ñ–≤
        }
        
        // –ù–û–í–ê –§–£–ù–ö–¶–Ü–Ø: –û–Ω–æ–≤–ª–µ–Ω–Ω—è Datalist –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤
        function updateClientDatalist() {
            const clientDatalist = document.getElementById('clientList');
            if (!clientDatalist) return;
            clientDatalist.innerHTML = '';
            
            const transactions = loadTransactions();
            const clientNames = new Set();
            
            transactions.forEach(t => {
                if (t.clientName && t.clientName.trim() !== '---' && t.clientName.trim().length > 0) {
                    clientNames.add(t.clientName.trim());
                }
            });
            
            Array.from(clientNames).sort().forEach(name => {
                 const option = document.createElement('option');
                 option.value = name;
                 clientDatalist.appendChild(option);
            });
        }


        // --- 3. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ---
        function showAdminMessage(text, color) {
            const messageElement = document.getElementById('admin-message');
            messageElement.textContent = text;
            messageElement.style.color = 'white';
            messageElement.style.backgroundColor = color === 'red' ? '#dc3545' : color === 'orange' ? '#ffc107' : '#28a745';
            messageElement.style.display = 'block';
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 5000);
        }

        // --- 4. –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö ---
        
        // –§—É–Ω–∫—Ü—ñ—ó –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ù–∞—Ü—ñ–Ω–∫–∞–º–∏ (–±–µ–∑ –∑–º—ñ–Ω)
        function addOrUpdateMarkupPreset() {
            let name = document.getElementById('adminMarkupName').value.trim();
            const value = parseFloat(document.getElementById('adminMarkupValue').value);
            
            if (!name) {
                showAdminMessage('–ù–∞–∑–≤–∞ –Ω–∞—Ü—ñ–Ω–∫–∏ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–æ—é.', 'red');
                return;
            }
            if (isNaN(value) || value <= 0 || value > 0.5) {
                showAdminMessage('–í—ñ–¥—Å–æ—Ç–æ–∫ –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º –≤—ñ–¥ 0.01 –¥–æ 0.50 (1% - 50%).', 'red');
                return;
            }

            const isNew = !MARKUP_PRESETS.hasOwnProperty(name);
            MARKUP_PRESETS[name] = value;
            saveMarkupPresets();
            
            showAdminMessage(
                isNew 
                    ? `‚úÖ –¢–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏ "${name}" –¥–æ–¥–∞–Ω–æ: ${(value * 100).toFixed(0)}%.` 
                    : `‚úÖ –¢–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏ "${name}" –æ–Ω–æ–≤–ª–µ–Ω–æ: ${(value * 100).toFixed(0)}%.`,
                'green'
            );

            document.getElementById('adminMarkupName').value = '';
            document.getElementById('adminMarkupValue').value = '';

            renderMarkupPresets();
            populateFormOptions();
        }

        function deleteMarkupPreset(name) {
            if (Object.keys(MARKUP_PRESETS).length <= 1) {
                showAdminMessage('–ü–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏.', 'red');
                return;
            }
            if (confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏ "${name}"? –¶–µ –Ω–µ –≤–ø–ª–∏–Ω–µ –Ω–∞ –º–∏–Ω—É–ª—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.`)) {
                delete MARKUP_PRESETS[name];
                saveMarkupPresets();
                renderMarkupPresets();
                populateFormOptions();
                showAdminMessage(`‚ùå –¢–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏ "${name}" —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.`, 'red');
            }
        }
        
        function renderMarkupPresets() {
            const tbody = document.getElementById('markup-presets-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            Object.keys(MARKUP_PRESETS).sort().forEach(name => {
                const value = MARKUP_PRESETS[name];
                const row = tbody.insertRow();
                row.insertCell().textContent = name;
                row.insertCell().textContent = `${(value * 100).toFixed(2)}% (${value.toFixed(2)})`;
                
                const actionCell = row.insertCell();
                actionCell.style.textAlign = 'center';

                const editButton = document.createElement('button');
                editButton.textContent = '‚úèÔ∏è –ó–º—ñ–Ω–∏—Ç–∏';
                editButton.className = 'action-button';
                editButton.onclick = () => {
                     document.getElementById('adminMarkupName').value = name;
                     document.getElementById('adminMarkupValue').value = value;
                     document.getElementById('adminMarkupName').scrollIntoView({ behavior: 'smooth' });
                     showAdminMessage(`‚úèÔ∏è –í–∏ —Ä–µ–¥–∞–≥—É—î—Ç–µ —Ç–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏: "${name}". –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å '–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏'.`, 'orange');
                };
                actionCell.appendChild(editButton);
                
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå –í–∏–¥–∞–ª–∏—Ç–∏';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#f44336';
                deleteButton.onclick = () => deleteMarkupPreset(name);
                actionCell.appendChild(deleteButton);
            });
        }
        
        // –§—É–Ω–∫—Ü—ñ—ó –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –î–∂–µ—Ä–µ–ª–∞–º–∏ –ü—Ä–æ–¥–∞–∂—É (–±–µ–∑ –∑–º—ñ–Ω)
        function addOrUpdateSalesSource() {
            let name = document.getElementById('adminSourceName').value.trim();
            
            if (!name) {
                showAdminMessage('–ù–∞–∑–≤–∞ –¥–∂–µ—Ä–µ–ª–∞ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–æ—é.', 'red');
                return;
            }
            if (SALES_SOURCES.includes(name)) {
                showAdminMessage(`–î–∂–µ—Ä–µ–ª–æ "${name}" –≤–∂–µ —ñ—Å–Ω—É—î.`, 'orange');
                return;
            }

            SALES_SOURCES.push(name);
            SALES_SOURCES.sort();
            saveSalesSources();
            
            showAdminMessage(`‚úÖ –î–∂–µ—Ä–µ–ª–æ "${name}" –¥–æ–¥–∞–Ω–æ.`, 'green');

            document.getElementById('adminSourceName').value = '';

            renderSalesSources();
            populateFormOptions();
        }

        function deleteSalesSource(name) {
            if (SALES_SOURCES.length <= 1) {
                showAdminMessage('–ü–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ç–∏–ø –¥–∂–µ—Ä–µ–ª–∞ (–Ω–∞–≤—ñ—Ç—å "–ù–µ –≤–∫–∞–∑–∞–Ω–æ").', 'red');
                return;
            }
            if (confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –¥–∂–µ—Ä–µ–ª–æ "${name}"? –¶–µ –Ω–µ –≤–ø–ª–∏–Ω–µ –Ω–∞ –º–∏–Ω—É–ª—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.`)) {
                SALES_SOURCES = SALES_SOURCES.filter(source => source !== name);
                saveSalesSources();
                renderSalesSources();
                populateFormOptions();
                showAdminMessage(`‚ùå –î–∂–µ—Ä–µ–ª–æ "${name}" —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.`, 'red');
            }
        }
        
        function renderSalesSources() {
            const tbody = document.getElementById('sales-sources-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            SALES_SOURCES.sort().forEach(name => {
                const row = tbody.insertCell();
                row.insertCell().textContent = name;
                
                const actionCell = row.insertCell();
                actionCell.style.textAlign = 'center';
                
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå –í–∏–¥–∞–ª–∏—Ç–∏';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#f44336';
                deleteButton.onclick = () => deleteSalesSource(name);
                actionCell.appendChild(deleteButton);
            });
        }

        // --- –ê–î–ú–Ü–ù-–§–£–ù–ö–¶–Ü–á –î–õ–Ø –ü–ê–†–§–£–ú–Ü–í –¢–ê –§–õ–ê–ö–û–ù–Ü–í (–±–µ–∑ –∑–º—ñ–Ω) ---
        
        function addOrUpdatePerfume() {
            let nameInput = document.getElementById('adminPerfumeName').value.trim();
            const basePrice = parseFloat(document.getElementById('adminBasePrice').value);
            const discountVolume = parseFloat(document.getElementById('adminDiscountVolume').value) || 0;
            const discountPrice = parseFloat(document.getElementById('adminDiscountPrice').value);

            if (!nameInput) {
                showAdminMessage('–ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–æ—é.', 'red');
                return;
            }
            if (isNaN(basePrice) || basePrice <= 0 || isNaN(discountPrice) || discountPrice <= 0) {
                showAdminMessage('–ë–∞–∑–æ–≤–∞ –¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ —Ç–∞ –¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ –∑—ñ –∑–Ω–∏–∂–∫–æ—é –º–∞—é—Ç—å –±—É—Ç–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–º–∏ —á–∏—Å–ª–∞–º–∏.', 'red');
                return;
            }
            if (discountPrice > basePrice) {
                showAdminMessage('–¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ –∑—ñ –∑–Ω–∏–∂–∫–æ—é –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—â–æ—é –∑–∞ –±–∞–∑–æ–≤—É –¶—ñ–Ω—É –ó–∞–∫—É–ø—ñ–≤–ª—ñ.', 'red');
                return;
            }
            if (discountVolume > 0 && discountPrice === basePrice) {
                showAdminMessage('–Ø–∫—â–æ –æ–±—Å—è–≥ –∑–Ω–∏–∂–∫–∏ –≤–∫–∞–∑–∞–Ω–æ, –¶—ñ–Ω–∞ –ó–∞–∫—É–ø—ñ–≤–ª—ñ –∑—ñ –∑–Ω–∏–∂–∫–æ—é –º–∞—î –±—É—Ç–∏ –Ω–∏–∂—á–æ—é –∑–∞ –ë–∞–∑–æ–≤—É –¶—ñ–Ω—É –ó–∞–∫—É–ø—ñ–≤–ª—ñ.', 'orange');
            }

            const isNew = !PERFUME_PRICES.hasOwnProperty(nameInput);
            PERFUME_PRICES[nameInput] = {
                basePrice: basePrice,
                discountVolume: discountVolume,
                discountPrice: discountPrice
            };
            savePerfumePrices();
            
            showAdminMessage(
                isNew 
                    ? `‚úÖ –ü–∞—Ä—Ñ—É–º "${nameInput}" –¥–æ–¥–∞–Ω–æ. (–ë–∞–∑. –°/–°: ${basePrice.toFixed(2)})` 
                    : `‚úÖ –¶—ñ–Ω–∏ –ó–∞–∫—É–ø—ñ–≤–ª—ñ –¥–ª—è "${nameInput}" –æ–Ω–æ–≤–ª–µ–Ω–æ.`,
                'green'
            );

            document.getElementById('adminPerfumeName').value = '';
            document.getElementById('adminBasePrice').value = '';
            document.getElementById('adminDiscountVolume').value = '';
            document.getElementById('adminDiscountPrice').value = '';

            renderPerfumeList();
            populateFormOptions();
        }

        function editPerfume(name, data) {
            document.getElementById('adminPerfumeName').value = name;
            document.getElementById('adminBasePrice').value = data.basePrice;
            document.getElementById('adminDiscountVolume').value = data.discountVolume;
            document.getElementById('adminDiscountPrice').value = data.discountPrice;
            document.getElementById('adminPerfumeName').scrollIntoView({ behavior: 'smooth' });
            showAdminMessage(`‚úèÔ∏è –í–∏ —Ä–µ–¥–∞–≥—É—î—Ç–µ –ø–∞—Ä—Ñ—É–º: "${name}". –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å '–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ —Ü—ñ–Ω—É –∑–∞–∫—É–ø—ñ–≤–ª—ñ'.`, 'orange');
        }

        function deletePerfume(name) {
            if (confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–∞—Ä—Ñ—É–º "${name}" –∑—ñ —Å–ø–∏—Å–∫—É? –¶–µ –Ω–µ –≤–∏–¥–∞–ª–∏—Ç—å –º–∏–Ω—É–ª—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.`)) {
                delete PERFUME_PRICES[name];
                savePerfumePrices();
                renderPerfumeList();
                populateFormOptions(); 
                showAdminMessage(`‚ùå –ü–∞—Ä—Ñ—É–º "${name}" —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.`, 'red');
            }
        }
        
        function addOrUpdateFlacon() {
            const volume = parseInt(document.getElementById('adminFlaconVolume').value);
            const cost = parseFloat(document.getElementById('adminFlaconCost').value);

            if (isNaN(volume) || volume <= 0 || isNaN(cost) || cost < 0) {
                showAdminMessage('–û–±—Å—è–≥ –º–∞—î –±—É—Ç–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–º —Ü—ñ–ª–∏–º —á–∏—Å–ª–æ–º, –∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å - –Ω–µ–≤—ñ–¥\'—î–º–Ω–∏–º —á–∏—Å–ª–æ–º.', 'red');
                return;
            }
            if (volume % 1 !== 0) {
                 showAdminMessage('–û–±—Å—è–≥ –º–∞—î –±—É—Ç–∏ —Ü—ñ–ª–∏–º —á–∏—Å–ª–æ–º.', 'red');
                return;
            }

            const isNew = !FLACON_VOLUMES.includes(volume);
            
            FLACON_COSTS[volume] = cost;
            
            if (isNew) {
                FLACON_VOLUMES.push(volume);
            }
            
            saveFlaconData();

            showAdminMessage(
                isNew 
                    ? `‚úÖ –§–ª–∞–∫–æ–Ω ${volume} –º–ª –¥–æ–¥–∞–Ω–æ. (–í–∞—Ä—Ç—ñ—Å—Ç—å: ${cost.toFixed(2)} UAH)` 
                    : `‚úÖ –í–∞—Ä—Ç—ñ—Å—Ç—å —Ñ–ª–∞–∫–æ–Ω—É ${volume} –º–ª –æ–Ω–æ–≤–ª–µ–Ω–æ –¥–æ ${cost.toFixed(2)} UAH.`,
                'green'
            );

            document.getElementById('adminFlaconVolume').value = '';
            document.getElementById('adminFlaconCost').value = '';
            
            populateFormOptions();
            renderFlaconList();
        }

        function deleteFlacon(volume) {
            if (confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ñ–ª–∞–∫–æ–Ω ${volume} –º–ª –∑—ñ —Å–ø–∏—Å–∫—É? –¶–µ –Ω–µ –≤–∏–¥–∞–ª–∏—Ç—å –º–∏–Ω—É–ª—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.`)) {
                delete FLACON_COSTS[volume];
                FLACON_VOLUMES = FLACON_VOLUMES.filter(v => v !== volume);
                saveFlaconData();
                showAdminMessage(`‚ùå –§–ª–∞–∫–æ–Ω ${volume} –º–ª –≤–∏–¥–∞–ª–µ–Ω–æ.`, 'red');
                populateFormOptions();
                renderFlaconList();
            }
        }


        // --- 5. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –û–î–ò–ù–ò–ß–ù–û–ì–û –ü–†–û–î–ê–ñ–£ (–±–µ–∑ –∑–º—ñ–Ω) ---
        function addSale(nameInput = null, quantity = null, clientName = null, markupTierName = null, source = null) {
            const isSingleSale = nameInput === null; 
            
            if(isSingleSale) {
                nameInput = document.getElementById('perfumeName').value.trim();
                quantity = parseFloat(document.getElementById('flaconVolume').value);
                clientName = document.getElementById('clientNameSingle').value.trim() || null; 
                markupTierName = document.getElementById('saleMarkupTierSingle').value; 
                source = document.getElementById('saleSourceSingle').value; 
            }
            
            const messageElement = document.getElementById('message');
            if (messageElement) messageElement.textContent = ''; 

            if (!nameInput || isNaN(quantity) || !markupTierName) {
                if (isSingleSale) {
                    messageElement.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è (–ü–∞—Ä—Ñ—É–º, –û–±'—î–º, –¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏).";
                    messageElement.style.backgroundColor = '#f8d7da'; 
                    messageElement.style.color = '#721c24'; 
                }
                return { success: false };
            }

            const baseCostPricePerML = getBaseCostPrice(nameInput);
            if (!baseCostPricePerML) {
                if (isSingleSale) {
                    messageElement.textContent = `–ü–æ–º–∏–ª–∫–∞: –ü–∞—Ä—Ñ—É–º "${nameInput}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –î–æ–¥–∞–π—Ç–µ –π–æ–≥–æ –≤ —Ä–æ–∑–¥—ñ–ª 8.`;
                    messageElement.style.backgroundColor = '#f8d7da';
                    messageElement.style.color = '#721c24';
                }
                return { success: false };
            }

            const flaconCost = FLACON_COSTS[quantity] || 0;
            const fixedSalePricePerML = calculateFixedSalePrice(baseCostPricePerML, markupTierName); 
            
            const revenueFromPerfumeUnrounded = fixedSalePricePerML * quantity; 

            const revenueFromPerfumeRounded = ROUND_TO_NEAREST_UAH 
                                            ? Math.round(revenueFromPerfumeUnrounded) 
                                            : parseFloat(revenueFromPerfumeUnrounded.toFixed(2));
            
            const revenueTotalRounded = revenueFromPerfumeRounded + flaconCost;
            
            const actualCostPricePerML = getActualCostPrice(nameInput, quantity);
            const perfumeCost = actualCostPricePerML * quantity;
            const totalExpense = perfumeCost + flaconCost;
            const profit = revenueTotalRounded - totalExpense; 

            const transaction = {
                id: Date.now(), 
                timestamp: Date.now(),
                clientName: clientName || '---', 
                source: source || '---', 
                markupTier: markupTierName, 
                perfumeName: nameInput,
                quantityML: quantity,
                flaconCost: flaconCost,
                revenue: revenueTotalRounded, 
                costPerfume: perfumeCost, 
                costTotal: totalExpense, 
                profit: profit,
                fixedSalePricePerML: fixedSalePricePerML.toFixed(2), 
            };

            const transactions = loadTransactions();
            transactions.push(transaction);
            saveTransactions(transactions);
            
            const minDigits = ROUND_TO_NEAREST_UAH ? 0 : 2;

            if (isSingleSale) {
                messageElement.innerHTML = `‚úÖ –ü—Ä–æ–¥–∞–∂ –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ (${clientName ? '–ö–ª—ñ—î–Ω—Ç: ' + clientName : '–±–µ–∑ –∫–ª—ñ—î–Ω—Ç–∞'} / –ù–∞—Ü—ñ–Ω–∫–∞: ${markupTierName}):<br> **${nameInput}** (${quantity} –º–ª) - **${revenueTotalRounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits })} UAH** (–ü—Ä–∏–±—É—Ç–æ–∫: ${profit.toFixed(2)} UAH)`;
                messageElement.style.backgroundColor = '#d4edda'; 
                messageElement.style.color = '#155724'; 
                
                document.getElementById('perfumeName').value = '';
                document.getElementById('flaconVolume').value = '';
                document.getElementById('clientNameSingle').value = '';
                document.getElementById('flaconVolume').value = '';
                
                updateClientDatalist(); // –û–ù–û–í–õ–ï–ù–û: –æ–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤
            }

            return { success: true, transaction: transaction };
        }

        // --- 6. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –û–¥–∏–Ω–∏—á–Ω–æ—ó –¶—ñ–Ω–∏ (–±–µ–∑ –∑–º—ñ–Ω) ---
        function calculatePrice() {
            const nameInput = document.getElementById('calcPerfumeName').value.trim();
            const quantity = parseFloat(document.getElementById('calcFlaconVolume').value);
            const markupTierName = document.getElementById('calcMarkupTier').value; 
            const resultElement = document.getElementById('calcResult');
            resultElement.innerHTML = '';
            
            if (!nameInput || isNaN(quantity) || !markupTierName) {
                resultElement.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è (–ü–∞—Ä—Ñ—É–º, –û–±'—î–º, –¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏).";
                resultElement.style.backgroundColor = '#f8d7da'; 
                resultElement.style.color = '#721c24'; 
                return;
            }

            const baseCostPricePerML = getBaseCostPrice(nameInput);
            if (!baseCostPricePerML) {
                resultElement.textContent = `–ü–æ–º–∏–ª–∫–∞: –ü–∞—Ä—Ñ—É–º "${nameInput}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –î–æ–¥–∞–π—Ç–µ –π–æ–≥–æ –≤ —Ä–æ–∑–¥—ñ–ª 8.`;
                resultElement.style.backgroundColor = '#f8d7da'; 
                resultElement.style.color = '#721c24'; 
                return;
            }

            const flaconCost = FLACON_COSTS[quantity] || 0;
            const fixedSalePricePerML = calculateFixedSalePrice(baseCostPricePerML, markupTierName); 
            
            const revenueFromPerfumeUnrounded = fixedSalePricePerML * quantity; 

            const revenueFromPerfumeRounded = ROUND_TO_NEAREST_UAH 
                                            ? Math.round(revenueFromPerfumeUnrounded) 
                                            : parseFloat(revenueFromPerfumeUnrounded.toFixed(2));
            
            const priceTotalRounded = revenueFromPerfumeRounded + flaconCost;

            const actualCostPricePerML = getActualCostPrice(nameInput, quantity);
            const perfumeCost = actualCostPricePerML * quantity;
            const totalExpense = perfumeCost + flaconCost;
            const potentialProfit = priceTotalRounded - totalExpense;
            
            const totalDisplayFormat = ROUND_TO_NEAREST_UAH ? 0 : 2;

            resultElement.innerHTML = `
                <div style="margin-bottom: 15px;">
                    üí∞ **–†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–ê –¶–Ü–ù–ê –î–õ–Ø –ö–õ–Ü–Ñ–ù–¢–ê (–û–ö–†–£–ì–õ–ï–ù–û, –ù–∞—Ü—ñ–Ω–∫–∞: ${markupTierName}):** ${priceTotalRounded.toLocaleString('uk-UA', { minimumFractionDigits: totalDisplayFormat })} UAH
                </div>
                <p style="font-size: 1.1em; color: #155724; font-weight: bold; margin: 5px 0;">
                    –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –ß–∏—Å—Ç–∏–π –ü—Ä–∏–±—É—Ç–æ–∫: <span style="color: ${potentialProfit >= 0 ? '#28a745' : '#dc3545'};">${potentialProfit.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH</span>
                </p>
                <hr style="border-top: 1px dashed #ccc; margin: 10px 0;">
                <table style="width: 100%; font-size: 0.9em; border-collapse: collapse; background-color: white; border: none;">
                    <tr> <td style="font-weight: bold; padding: 3px 0;">–ü—Ä–æ–¥–∞–∂ –ü–∞—Ä—Ñ—É–º—É (–º–ª):</td> <td style="text-align: right;">${quantity} –º–ª</td> </tr>
                    <tr> <td style="font-weight: bold; padding: 3px 0;">–¶—ñ–Ω–∞ –ü—Ä–æ–¥–∞–∂—É –∑–∞ 1 –º–ª (–§—ñ–∫—Å):</td> <td style="text-align: right;">${fixedSalePricePerML.toFixed(2)} UAH</td> </tr>
                    <tr> <td style="padding: 3px 0;">–í–∞—Ä—Ç—ñ—Å—Ç—å –§–ª–∞–∫–æ–Ω—É:</td> <td style="text-align: right;">${flaconCost.toFixed(2)} UAH</td> </tr>
                    <tr> <td style="padding: 3px 0;">–°–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å 1 –º–ª (–ê–∫—Ç—É–∞–ª—å–Ω–∞):</td> <td style="text-align: right; color: ${actualCostPricePerML === baseCostPricePerML ? '#555' : 'red'};">${actualCostPricePerML.toFixed(2)} UAH</td> </tr>
                    <tr> <td style="font-weight: bold; padding: 3px 0; border-top: 1px dashed #ccc;">–ó–∞–≥–∞–ª—å–Ω–∞ –°–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å:</td> <td style="text-align: right; font-weight: bold; border-top: 1px dashed #ccc;">${totalExpense.toFixed(2)} UAH</td> </tr>
                </table>
            `;
            resultElement.style.backgroundColor = 'white'; 
            resultElement.style.color = '#333';
            resultElement.style.border = '1px solid #ced4da';
        }
        
        // --- 7. –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è (–±–µ–∑ –∑–º—ñ–Ω) ---
        let orderItemIdCounter = 0;

        function addItemToOrder() {
            const name = document.getElementById('orderPerfumeName').value.trim();
            const volume = parseFloat(document.getElementById('orderFlaconVolume').value);
            const markupTierName = document.getElementById('saleMarkupTierOrder').value; 
            const orderMessage = document.getElementById('orderMessage');
            
            if (!name || isNaN(volume) || !markupTierName) {
                orderMessage.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –ø–∞—Ä—Ñ—É–º, –æ–±'—î–º —Ç–∞ —Ç–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏.";
                orderMessage.style.backgroundColor = '#f8d7da'; 
                orderMessage.style.color = '#721c24'; 
                return;
            }

            const baseCostPricePerML = getBaseCostPrice(name);
            if (!baseCostPricePerML) {
                orderMessage.textContent = `–ü–æ–º–∏–ª–∫–∞: –ü–∞—Ä—Ñ—É–º "${name}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –î–æ–¥–∞–π—Ç–µ –π–æ–≥–æ –≤ —Ä–æ–∑–¥—ñ–ª 8.`;
                orderMessage.style.backgroundColor = '#f8d7da'; 
                orderMessage.style.color = '#721c24'; 
                return;
            }
            
            const flaconCost = FLACON_COSTS[volume] || 0;
            const fixedSalePricePerML = calculateFixedSalePrice(baseCostPricePerML, markupTierName); 
            
            const revenueFromPerfumeUnrounded = fixedSalePricePerML * volume; 

            const revenueFromPerfumeRounded = ROUND_TO_NEAREST_UAH 
                                            ? Math.round(revenueFromPerfumeUnrounded) 
                                            : parseFloat(revenueFromPerfumeUnrounded.toFixed(2));
            
            const priceForLineItem = revenueFromPerfumeRounded + flaconCost;

            orderItemIdCounter++;
            
            CURRENT_ORDER_LIST.push({
                id: orderItemIdCounter,
                perfumeName: name,
                quantityML: volume,
                flaconCost: flaconCost,
                priceUnrounded: priceForLineItem, 
                fixedSalePricePerML: fixedSalePricePerML,
                markupTier: markupTierName, 
            });

            document.getElementById('orderPerfumeName').value = ''; 
            document.getElementById('orderFlaconVolume').selectedIndex = 0; 
            orderMessage.textContent = `‚úÖ –ü–æ–∑–∏—Ü—ñ—é "${name} (${volume} –º–ª)" –¥–æ–¥–∞–Ω–æ –¥–æ —Å–ø–∏—Å–∫—É. (–ù–∞—Ü—ñ–Ω–∫–∞: ${markupTierName})`;
            orderMessage.style.backgroundColor = '#d4edda';
            orderMessage.style.color = '#155724';

            renderOrderList();
        }

        function removeOrderItem(id) {
            CURRENT_ORDER_LIST = CURRENT_ORDER_LIST.filter(item => item.id !== id);
            renderOrderList();
        }
        
        function updateClientSummary(orderItems, totalRounded) {
            const outputElement = document.getElementById('clientSummaryOutput');
            const clientName = document.getElementById('clientNameOrder').value.trim();
            if (!outputElement) return;

            if (orderItems.length === 0) {
                outputElement.textContent = "–°–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ–π.";
                return;
            }
            
            const minDigits = ROUND_TO_NEAREST_UAH ? 0 : 2;

            let summary = clientName ? `–ö–ª—ñ—î–Ω—Ç: ${clientName}\n` : "";
            
            const markupTierName = document.getElementById('saleMarkupTierOrder').value; 
            summary += `–¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏: ${markupTierName}\n\n`;

            orderItems.forEach(item => {
                const itemPriceFormatted = item.priceUnrounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits }); 
                summary += `${item.perfumeName} (${item.quantityML} –º–ª) - ${itemPriceFormatted} UAH\n`;
            });

            const totalFormatted = totalRounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits });

            summary += `\n–†–ê–ó–û–ú: ${totalFormatted} UAH`;
            
            outputElement.textContent = summary;
        }


        function renderOrderList() {
            const tbody = document.getElementById('order-list-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            let totalUnroundedPrice = 0; 
            const minDigits = ROUND_TO_NEAREST_UAH ? 0 : 2;

            CURRENT_ORDER_LIST.forEach(item => {
                totalUnroundedPrice += item.priceUnrounded;
                
                const row = tbody.insertRow();
                row.insertCell().textContent = item.perfumeName;
                row.insertCell().textContent = `${item.quantityML} –º–ª`;
                row.insertCell().textContent = item.priceUnrounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits }) + ' UAH';
                
                const actionCell = row.insertCell();
                const removeButton = document.createElement('button');
                removeButton.textContent = '‚ùå';
                removeButton.className = 'action-button';
                removeButton.style.backgroundColor = '#dc3545';
                removeButton.style.width = '30px';
                removeButton.onclick = () => removeOrderItem(item.id);
                actionCell.appendChild(removeButton);
            });
            
            const totalRounded = parseFloat(totalUnroundedPrice.toFixed(2)); 
            const totalSection = document.getElementById('orderTotalSection');

            if (CURRENT_ORDER_LIST.length > 0) {
                const markupTierName = document.getElementById('saleMarkupTierOrder').value; 
                totalSection.innerHTML = `
                    <div class="order-total">
                        –ó–∞–≥–∞–ª—å–Ω–∞ –°—É–º–∞ –¥–ª—è –ö–ª—ñ—î–Ω—Ç–∞ (–ù–∞—Ü—ñ–Ω–∫–∞: ${markupTierName}): ${totalRounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits })} UAH
                    </div>
                    <p style="text-align: center; font-size: 0.9em; margin-top: 5px; color: #555;"> 
                        (–°—É–º–∞ –ø–æ–∑–∏—Ü—ñ–π –∑ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–º –ø–∞—Ä—Ñ—É–º–æ–º)
                    </p>
                `;
            } else {
                 totalSection.innerHTML = '';
            }
            
            updateClientSummary(CURRENT_ORDER_LIST, totalRounded);
        }

        function processOrder() {
            if (CURRENT_ORDER_LIST.length === 0) {
                document.getElementById('orderMessage').textContent = "–°–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ–π.";
                document.getElementById('orderMessage').style.backgroundColor = '#f8d7da'; 
                document.getElementById('orderMessage').style.color = '#721c24'; 
                return;
            }

            const finalSum = CURRENT_ORDER_LIST.reduce((sum, item) => sum + item.priceUnrounded, 0);
            const totalRounded = parseFloat(finalSum.toFixed(2));
            
            const clientName = document.getElementById('clientNameOrder').value.trim() || null;
            const markupTierName = document.getElementById('saleMarkupTierOrder').value;
            const source = document.getElementById('saleSourceOrder').value;

            let allSuccessful = true;
            const itemsToProcess = [...CURRENT_ORDER_LIST]; 

            itemsToProcess.forEach(item => {
                const result = addSale(item.perfumeName, item.quantityML, clientName, markupTierName, source); 
                if (!result.success) {
                    allSuccessful = false;
                }
            });

            if (allSuccessful) {
                showReceiptModal(itemsToProcess, totalRounded, clientName);
                
                document.getElementById('clientNameOrder').value = '';
                clearOrder(false); 

            } else {
                document.getElementById('orderMessage').textContent = "–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ñ—ñ–∫—Å–∞—Ü—ñ—ó –¥–µ—è–∫–∏—Ö –ø–æ–∑–∏—Ü—ñ–π. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–∞—Ä—Ñ—É–º—ñ–≤.";
                document.getElementById('orderMessage').style.backgroundColor = '#f8d7da';
                document.getElementById('orderMessage').style.color = '#721c24';
            }
            updateClientDatalist(); // –û–ù–û–í–õ–ï–ù–û: –æ–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤
        }

        function clearOrder(clearMsg = true) {
            CURRENT_ORDER_LIST = [];
            renderOrderList();
            if (clearMsg) {
                document.getElementById('orderMessage').textContent = '–°–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–æ.';
                document.getElementById('orderMessage').style.backgroundColor = '#f8d7da'; 
                document.getElementById('orderMessage').style.color = '#721c24'; 
                setTimeout(() => {
                   document.getElementById('orderMessage').textContent = '';
                   document.getElementById('orderMessage').style.backgroundColor = '';
                   document.getElementById('orderMessage').style.color = '';
                }, 3000);
            }
        }
        
        // --- 8. –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –í–∏—Ç—Ä–∞—Ç (–±–µ–∑ –∑–º—ñ–Ω) ---
        function addExpense() {
            const description = document.getElementById('expenseDescription').value.trim();
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const expenseMessage = document.getElementById('expenseMessage');

            if (!description || isNaN(amount) || amount <= 0) {
                expenseMessage.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–ø–∏—Å —Ç–∞ –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É —Å—É–º—É –≤–∏—Ç—Ä–∞—Ç–∏.";
                expenseMessage.style.backgroundColor = '#f8d7da'; 
                expenseMessage.style.color = '#721c24'; 
                return;
            }

            const expense = {
                id: Date.now(),
                timestamp: Date.now(),
                date: new Date().toISOString().split('T')[0],
                description: description,
                amount: amount
            };

            const expenses = loadExpenses();
            expenses.push(expense);
            saveExpenses(expenses);

            document.getElementById('expenseDescription').value = '';
            document.getElementById('expenseAmount').value = '';
            expenseMessage.textContent = `‚úÖ –í–∏—Ç—Ä–∞—Ç—É "${description}" –Ω–∞ —Å—É–º—É ${amount.toFixed(2)} UAH –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ.`;
            expenseMessage.style.backgroundColor = '#d4edda';
            expenseMessage.style.color = '#155724';
            renderExpenseList();
            
            setTimeout(() => {
                   expenseMessage.textContent = '';
                   expenseMessage.style.backgroundColor = '';
                   expenseMessage.style.color = '';
                }, 5000);
        }
        
        function renderExpenseList() {
            const tbody = document.getElementById('expense-list-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            let expenses = loadExpenses().sort((a, b) => b.timestamp - a.timestamp); 
            
            expenses.forEach(exp => {
                const row = tbody.insertRow();
                row.insertCell().textContent = exp.date;
                row.insertCell().textContent = exp.description;
                row.insertCell().textContent = exp.amount.toFixed(2);
                
                const actionCell = row.insertCell();
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#dc3545';
                deleteButton.style.width = '30px';
                deleteButton.onclick = () => deleteExpense(exp.id);
                actionCell.appendChild(deleteButton);
            });
        }

        function deleteExpense(id) {
            if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –≤–∏—Ç—Ä–∞—Ç—É?")) {
                let expenses = loadExpenses();
                expenses = expenses.filter(exp => exp.id !== id);
                saveExpenses(expenses);
                const expenseMessage = document.getElementById('expenseMessage');
                expenseMessage.textContent = '‚ùå –í–∏—Ç—Ä–∞—Ç—É –≤–∏–¥–∞–ª–µ–Ω–æ.';
                expenseMessage.style.backgroundColor = '#f8d7da'; 
                expenseMessage.style.color = '#721c24'; 
                renderExpenseList();
                 setTimeout(() => {
                   expenseMessage.textContent = '';
                   expenseMessage.style.backgroundColor = '';
                   expenseMessage.style.color = '';
                }, 3000);
            }
        }
        
        // --- 9. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ì–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ó–≤—ñ—Ç—É (–±–µ–∑ –∑–º—ñ–Ω) ---
        function generateReport() {
            const startDateInput = document.getElementById('startDate').value;
            const endDateInput = document.getElementById('endDate').value;
            const output = document.getElementById('reportOutput');
            output.innerHTML = '';

            let transactions = loadTransactions();
            let expenses = loadExpenses(); 

            const startTimestamp = startDateInput ? new Date(startDateInput).getTime() : 0;
            const endTimestamp = endDateInput ? new Date(endDateInput).setHours(23, 59, 59, 999) : Infinity;

            transactions = transactions.filter(t => t.timestamp >= startTimestamp && t.timestamp <= endTimestamp);
            expenses = expenses.filter(e => e.timestamp >= startTimestamp && e.timestamp <= endTimestamp);


            if (transactions.length === 0 && expenses.length === 0) {
                output.innerHTML = '<p class="message" style="background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;">‚ö†Ô∏è –ó–∞ –æ–±—Ä–∞–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π —Ç–∞ –≤–∏—Ç—Ä–∞—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>';
                return;
            }

            const totalRevenue = transactions.reduce((sum, t) => sum + t.revenue, 0);
            const totalFlaconCost = transactions.reduce((sum, t) => sum + t.flaconCost, 0);
            const totalCostPerfume = transactions.reduce((sum, t) => sum + t.costPerfume, 0);
            const totalTransactionProfit = transactions.reduce((sum, t) => sum + t.profit, 0); 
            const totalOtherExpenses = expenses.reduce((sum, e) => sum + e.amount, 0); 
            
            const netProfit = totalTransactionProfit - totalOtherExpenses;

            const mlReport = {};
            transactions.forEach(t => {
                mlReport[t.perfumeName] = (mlReport[t.perfumeName] || 0) + t.quantityML;
            });
            
            const sourceReport = {};
            transactions.forEach(t => {
                const source = t.source || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ';
                sourceReport[source] = (sourceReport[source] || 0) + t.profit;
            });
            
            const revenueFromPerfumeOnly = totalRevenue - totalFlaconCost;
            const profitFromPerfume = totalTransactionProfit; 
            const expenseOnlyPerfume = totalCostPerfume;

            let htmlContent = `
                <p style="font-weight: bold; font-size: 1.1em; color: #0056b3; margin-top: 10px;">
                    üìÖ –ó–≤—ñ—Ç–Ω–∏–π –ü–µ—Ä—ñ–æ–¥: ${startDateInput || '–í–µ—Å—å —á–∞—Å'} –ø–æ ${endDateInput || '–°—å–æ–≥–æ–¥–Ω—ñ'}
                </p>
                <hr style="border-top: 1px solid #ced4da; margin-bottom: 20px;">

                <h3>üìä –ó–≤–µ–¥–µ–Ω–∏–π –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –ó–≤—ñ—Ç:</h3>
                <div class="table-responsive">
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–ü–æ–∫–∞–∑–Ω–∏–∫</th>
                                <th>–°—É–º–∞ (UAH)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background-color: #e9ecef; font-weight: bold;">
                                <td>üí∞ –ó–ê–ì–ê–õ–¨–ù–ê –í–ò–†–£–ß–ö–ê (–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –¶—ñ–Ω–∞)</td>
                                <td>${totalRevenue.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                            <tr>
                                <td>–í–∏—Ä—É—á–∫–∞ –≤—ñ–¥ –ü–∞—Ä—Ñ—É–º—É (–±–µ–∑ –≤–∞—Ä—Ç–æ—Å—Ç—ñ —Ñ–ª–∞–∫–æ–Ω—ñ–≤)</td>
                                <td>${revenueFromPerfumeOnly.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                            <tr>
                                <td>–í–∏—Ä—É—á–∫–∞ –≤—ñ–¥ –§–ª–∞–∫–æ–Ω—ñ–≤ (–ö–æ–º–ø–µ–Ω—Å—É—î –≤–∏—Ç—Ä–∞—Ç—É –Ω–∞ —Ñ–ª–∞–∫–æ–Ω–∏)</td>
                                <td>${totalFlaconCost.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                             <tr style="background-color: #f8d7da; color: #721c24;">
                                <td style="font-weight: bold;">üí∏ –Ü–Ω—à—ñ –í–∏—Ç—Ä–∞—Ç–∏ (–û—Ä–µ–Ω–¥–∞, –ó–∞–∫—É–ø—ñ–≤–ª—ñ —Ç–æ—â–æ)</td>
                                <td style="font-weight: bold;">${totalOtherExpenses.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                            <tr>
                                <td>üí∏ –í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –ü–∞—Ä—Ñ—É–º (–°–æ–±—ñ–≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç—É –ø–æ –ê–∫—Ç—É–∞–ª—å–Ω—ñ–π –°/–°)</td>
                                <td>${expenseOnlyPerfume.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                            <tr style="background-color: #e2e3e5; font-weight: bold;">
                                <td>‚úÖ –ü—Ä–∏–±—É—Ç–æ–∫ –∑ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π (–î–æ –≤–∏—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —ñ–Ω. –≤–∏—Ç—Ä–∞—Ç)</td>
                                <td>${profitFromPerfume.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                            <tr style="background-color: ${netProfit >= 0 ? '#d4edda' : '#f8d7da'}; color: ${netProfit >= 0 ? '#155724' : '#721c24'};">
                                <td style="font-weight: bold;">üìà –ß–ò–°–¢–ò–ô –ü–†–ò–ë–£–¢–û–ö (–ü—Ä–∏–±—É—Ç–æ–∫ - –£—Å—ñ –í–∏—Ç—Ä–∞—Ç–∏)</td>
                                <td style="font-weight: bold;">${netProfit.toLocaleString('uk-UA', { minimumFractionDigits: 2 })}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>üìç –ü—Ä–∏–±—É—Ç–æ–∫ –∑–∞ –î–∂–µ—Ä–µ–ª–∞–º–∏ –ü—Ä–æ–¥–∞–∂—É:</h3>
                <ul style="list-style-type: square; padding-left: 20px;">
            `;
            
            const sortedSourceReport = Object.entries(sourceReport).sort(([, a], [, b]) => b - a);

            for (const [source, profit] of sortedSourceReport) {
                htmlContent += `<li>${source}: <strong style="color: ${profit >= 0 ? '#28a745' : '#dc3545'};">${profit.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH</strong></li>`;
            }
            
            htmlContent += `
                </ul>
                
                <h3>üì¶ –î–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è: –ü—Ä–æ–¥–∞–Ω–æ –ü–∞—Ä—Ñ—É–º—ñ–≤ (–º–ª):</h3>
                <ul style="list-style-type: square; padding-left: 20px;">
            `;
            
            const sortedMlReport = Object.entries(mlReport).sort(([, a], [, b]) => b - a);

            for (const [name, ml] of sortedMlReport) {
                htmlContent += `<li>${name}: <strong>${ml.toFixed(1)} –º–ª</strong></li>`;
            }
            htmlContent += '</ul>';

            output.innerHTML = htmlContent;
        }

        // --- 10. –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ–≤—ñ–¥–Ω–∏–∫—ñ–≤ (–±–µ–∑ –∑–º—ñ–Ω) ---
        
        function renderPerfumeList() {
            const tbody = document.getElementById('perfume-list-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            const searchInput = document.getElementById('perfumeSearchInput');
            const searchTerm = searchInput ? searchInput.value.toLowerCase().trim() : '';
            
            const filteredPerfumes = Object.keys(PERFUME_PRICES)
                .filter(name => name.toLowerCase().includes(searchTerm))
                .sort(); 

            filteredPerfumes.forEach(name => {
                const data = PERFUME_PRICES[name];
                const row = tbody.insertRow();
                row.insertCell().textContent = name;
                row.insertCell().textContent = data.basePrice.toFixed(2);
                
                const discountVolumeCell = row.insertCell();
                discountVolumeCell.textContent = data.discountVolume === 0 ? '–ù–Ü' : `${data.discountVolume} –º–ª`;
                discountVolumeCell.style.color = data.discountVolume === 0 ? '#aaa' : '#28a745';
                discountVolumeCell.style.textAlign = 'center';
                
                row.insertCell().textContent = data.discountPrice.toFixed(2);
                
                const actionCell = row.insertCell();
                actionCell.style.textAlign = 'center';
                
                const editButton = document.createElement('button');
                editButton.textContent = '‚úèÔ∏è –ó–º—ñ–Ω–∏—Ç–∏';
                editButton.className = 'action-button';
                editButton.onclick = () => editPerfume(name, data);
                actionCell.appendChild(editButton);
                
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå –í–∏–¥–∞–ª–∏—Ç–∏';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#f44336';
                deleteButton.onclick = () => deletePerfume(name);
                actionCell.appendChild(deleteButton);
            });
            
             if (searchTerm.length > 0) {
                 const content = document.getElementById('perfume-content');
                 const icon = document.getElementById('perfume-toggle-icon');
                 if (!content.classList.contains('active')) {
                     content.classList.add('active');
                     icon.textContent = '‚ñ≤';
                 }
             }
        }
        
        function togglePerfumeList() {
            const content = document.getElementById('perfume-content');
            const icon = document.getElementById('perfume-toggle-icon');
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.textContent = '‚ñº';
            } else {
                content.classList.add('active');
                icon.textContent = '‚ñ≤';
            }
        }
        
        function renderFlaconList() {
            const tbody = document.getElementById('flacon-list-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            FLACON_VOLUMES.sort((a, b) => a - b).forEach(volume => {
                const cost = FLACON_COSTS[volume] || 0;
                const row = tbody.insertRow();
                row.insertCell().textContent = volume;
                row.insertCell().textContent = cost.toFixed(2);

                const actionCell = row.insertCell();
                actionCell.style.textAlign = 'center';
                
                const editButton = document.createElement('button');
                editButton.textContent = '‚úèÔ∏è –ó–º—ñ–Ω–∏—Ç–∏';
                editButton.className = 'action-button';
                editButton.onclick = () => {
                     document.getElementById('adminFlaconVolume').value = volume;
                     document.getElementById('adminFlaconCost').value = cost;
                     document.getElementById('adminFlaconVolume').scrollIntoView({ behavior: 'smooth' });
                     showAdminMessage(`‚úèÔ∏è –í–∏ —Ä–µ–¥–∞–≥—É—î—Ç–µ —Ñ–ª–∞–∫–æ–Ω: ${volume} –º–ª. –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å '–î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏ –≤–∞—Ä—Ç—ñ—Å—Ç—å —Ñ–ª–∞–∫–æ–Ω—É'.`, 'orange');
                };
                actionCell.appendChild(editButton);
                
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå –í–∏–¥–∞–ª–∏—Ç–∏';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#f44336';
                deleteButton.onclick = () => deleteFlacon(volume);
                actionCell.appendChild(deleteButton);
            });
        }

        // --- 11. –§—É–Ω–∫—Ü—ñ—ó –Ü—Å—Ç–æ—Ä—ñ—ó –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π (–±–µ–∑ –∑–º—ñ–Ω) ---
        function renderTransactionHistory() {
            const tbody = document.getElementById('transaction-history-table').getElementsByTagName('tbody')[0];
            const search = document.getElementById('transactionSearch').value.toLowerCase().trim();
            const startDateInput = document.getElementById('historyStartDate').value;
            const endDateInput = document.getElementById('historyEndDate').value;
            const filterSource = document.getElementById('historyFilterSource').value; 
            const filterMarkup = document.getElementById('historyFilterMarkup').value; 
            const summaryElement = document.getElementById('transactionSummary');
            
            tbody.innerHTML = '';
            let transactions = loadTransactions().sort((a, b) => b.timestamp - a.timestamp); 
            
            const startTimestamp = startDateInput ? new Date(startDateInput).getTime() : 0;
            const endTimestamp = endDateInput ? new Date(endDateInput).setHours(23, 59, 59, 999) : Infinity;

            transactions = transactions.filter(t => t.timestamp >= startTimestamp && t.timestamp <= endTimestamp);

            let totalRevenue = 0;
            let totalProfit = 0;
            let filteredCount = 0;

            transactions.forEach(t => {
                const clientName = t.clientName && t.clientName.trim().length > 0 ? t.clientName : '---';
                const source = t.source || '---'; 
                const markup = t.markupTier || '---'; 
                
                if (search.length > 0 && 
                    !t.perfumeName.toLowerCase().includes(search) &&
                    !clientName.toLowerCase().includes(search)) {
                    return; 
                }
                
                if (filterSource && filterSource !== '' && source !== filterSource) {
                    return;
                }
                
                if (filterMarkup && filterMarkup !== '' && markup !== filterMarkup) {
                    return;
                }
                
                filteredCount++;
                totalRevenue += t.revenue;
                totalProfit += t.profit;

                const row = tbody.insertRow();
                const dateTime = new Date(t.timestamp).toLocaleString('uk-UA', { 
                    year: 'numeric', month: 'numeric', day: 'numeric', 
                    hour: '2-digit', minute: '2-digit'
                });
                
                row.insertCell().textContent = dateTime;
                row.insertCell().textContent = clientName;
                row.insertCell().innerHTML = `<strong>${source}</strong> / ${markup}`; 
                row.insertCell().textContent = `${t.perfumeName} (${t.quantityML} –º–ª)`;
                row.insertCell().textContent = t.revenue.toLocaleString('uk-UA', { minimumFractionDigits: 2 });
                
                const profitCell = row.insertCell();
                profitCell.textContent = t.profit.toLocaleString('uk-UA', { minimumFractionDigits: 2 });
                profitCell.style.color = t.profit >= 0 ? '#155724' : '#dc3545';
                profitCell.style.fontWeight = 'bold';
                
                const actionCell = row.insertCell();
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '‚ùå';
                deleteButton.className = 'action-button';
                deleteButton.style.backgroundColor = '#dc3545';
                deleteButton.style.width = '30px';
                deleteButton.onclick = () => deleteTransaction(t.id);
                actionCell.appendChild(deleteButton);
            });
            
            summaryElement.innerHTML = `
                **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π (–≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ):** ${filteredCount}
                | **–ó–∞–≥–∞–ª—å–Ω–∞ –í–∏—Ä—É—á–∫–∞:** ${totalRevenue.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH
                | **–ó–∞–≥–∞–ª—å–Ω–∏–π –ü—Ä–∏–±—É—Ç–æ–∫:** <span style="color: ${totalProfit >= 0 ? '#28a745' : '#dc3545'}; font-weight: bold;">${totalProfit.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH</span>
            `;
            summaryElement.style.display = 'block';
            summaryElement.style.backgroundColor = '#e6f7ff';
            summaryElement.style.color = '#004085';
        }

        function deleteTransaction(id) {
            if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é? –¶–µ –≤–ø–ª–∏–Ω–µ –Ω–∞ –≤–∞—à –ó–í–Ü–¢ —Ç–∞ –Ü–°–¢–û–†–Ü–Æ –ö–õ–Ü–Ñ–ù–¢–Ü–í.")) {
                let transactions = loadTransactions();
                transactions = transactions.filter(t => t.id !== id);
                saveTransactions(transactions);
                
                const messageElement = document.getElementById('transactionSummary');
                messageElement.textContent = '‚ùå –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é –≤–∏–¥–∞–ª–µ–Ω–æ. –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫...';
                messageElement.style.backgroundColor = '#f8d7da'; 
                messageElement.style.color = '#721c24'; 
                
                renderTransactionHistory();
                generateReport(); 
                updateClientDatalist(); // –û–ù–û–í–õ–ï–ù–û: –æ–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤
                
                setTimeout(() => {
                   messageElement.style.backgroundColor = '#e6f7ff';
                   messageElement.style.color = '#004085';
                }, 3000);
            }
        }
        
        // --- 12. –ù–û–í–ê –§–£–ù–ö–¶–Ü–Ø: –Ü—Å—Ç–æ—Ä—ñ—è –ö–ª—ñ—î–Ω—Ç–∞ (CRM) ---
        function showClientHistory() {
            const clientNameInput = document.getElementById('clientSearchInput').value.trim();
            const summaryElement = document.getElementById('clientCrmSummary');
            const tbody = document.getElementById('client-history-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            summaryElement.innerHTML = '';

            if (!clientNameInput || clientNameInput === '---') {
                 summaryElement.innerHTML = '<p class="message" style="background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;">‚ö†Ô∏è –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —ñ–º\'—è –∫–ª—ñ—î–Ω—Ç–∞.</p>';
                 return;
            }

            const transactions = loadTransactions();
            const clientTransactions = transactions
                .filter(t => t.clientName && t.clientName.trim().toLowerCase() === clientNameInput.toLowerCase());

            if (clientTransactions.length === 0) {
                 summaryElement.innerHTML = `<p class="message" style="background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">‚ùå –ö–ª—ñ—î–Ω—Ç "${clientNameInput}" –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π —É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è—Ö.</p>`;
                 return;
            }

            // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø—ñ–¥—Å—É–º–∫—ñ–≤
            const totalRevenue = clientTransactions.reduce((sum, t) => sum + t.revenue, 0);
            const totalProfit = clientTransactions.reduce((sum, t) => sum + t.profit, 0);
            const totalML = clientTransactions.reduce((sum, t) => sum + t.quantityML, 0);
            const transactionCount = clientTransactions.length;
            const lastPurchaseDate = new Date(Math.max(...clientTransactions.map(t => t.timestamp))).toLocaleDateString('uk-UA');
            
            
            // –í–∏–≤–µ–¥–µ–Ω–Ω—è –ø—ñ–¥—Å—É–º–∫—ñ–≤
            summaryElement.innerHTML = `
                <h3 style="margin-top: 0; color: #004085;">‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –ö–ª—ñ—î–Ω—Ç–∞: ${clientNameInput}</h3>
                <p>
                    <strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω—å:</strong> ${transactionCount}<br>
                    <strong>–ó–∞–≥–∞–ª—å–Ω–∞ –í–∏—Ä—É—á–∫–∞:</strong> <span style="font-size: 1.2em; color: #0056b3;">${totalRevenue.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH</span><br>
                    <strong>–°—É–∫—É–ø–Ω–∏–π –ü—Ä–∏–±—É—Ç–æ–∫:</strong> <span style="font-size: 1.2em; color: ${totalProfit >= 0 ? '#28a745' : '#dc3545'};">${totalProfit.toLocaleString('uk-UA', { minimumFractionDigits: 2 })} UAH</span><br>
                    <strong>–í—Å—å–æ–≥–æ –∫—É–ø–ª–µ–Ω–æ:</strong> ${totalML.toFixed(1)} –º–ª<br>
                    <strong>–û—Å—Ç–∞–Ω–Ω—è –ü–æ–∫—É–ø–∫–∞:</strong> ${lastPurchaseDate}
                </p>
            `;

            // –í–∏–≤–µ–¥–µ–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
            clientTransactions.sort((a, b) => b.timestamp - a.timestamp).forEach(t => {
                const row = tbody.insertRow();
                const dateTime = new Date(t.timestamp).toLocaleString('uk-UA', { 
                    year: 'numeric', month: 'numeric', day: 'numeric', 
                    hour: '2-digit', minute: '2-digit'
                });
                
                row.insertCell().textContent = dateTime;
                row.insertCell().textContent = `${t.perfumeName} (${t.quantityML} –º–ª)`;
                row.insertCell().textContent = t.revenue.toLocaleString('uk-UA', { minimumFractionDigits: 2 });
                
                const profitCell = row.insertCell();
                profitCell.textContent = t.profit.toLocaleString('uk-UA', { minimumFractionDigits: 2 });
                profitCell.style.color = t.profit >= 0 ? '#155724' : '#dc3545';
            });
        }


        // --- 13. –ü–æ–≤–Ω–∏–π –°–∫–∏–¥–∞–Ω–Ω—è (–±–µ–∑ –∑–º—ñ–Ω) ---
        function clearAllData() {
            if (confirm("–£–í–ê–ì–ê! –¶–µ –ø–æ–≤–Ω—ñ—Å—Ç—é –û–ß–ò–°–¢–ò–¢–¨ –í–°–Ü –≤–∞—à—ñ –¥–∞–Ω—ñ (—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó, –≤–∏—Ç—Ä–∞—Ç–∏, —Ü—ñ–Ω–∏ –ø–∞—Ä—Ñ—É–º—ñ–≤, –Ω–∞—Ü—ñ–Ω–∫—É). –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ?")) {
                localStorage.clear(); 
                saveInitialDataToLocalStorage(); 
                
                alert('–£—Å—ñ –¥–∞–Ω—ñ –æ—á–∏—â–µ–Ω–æ, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —Å—Ç–∞—Ä—Ç–æ–≤—ñ —Ü—ñ–Ω–∏. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–ª—è –ø–æ–≤–Ω–æ—ó –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ.');
                window.location.reload(); 
            }
        }

        // --- 14. –§—É–Ω–∫—Ü—ñ—ó –†–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è (–û–ù–û–í–õ–ï–ù–û: –≤–µ—Ä—Å—ñ—è) ---
        function downloadBackup() {
            const backupData = {
                transactions: loadTransactions(),
                expenses: loadExpenses(),
                perfumePrices: PERFUME_PRICES,
                flaconCosts: FLACON_COSTS,
                flaconVolumes: FLACON_VOLUMES,
                markupPresets: MARKUP_PRESETS, 
                salesSources: SALES_SOURCES, 
                meta: {
                    version: "11.1", // –û–ù–û–í–õ–ï–ù–û
                    date: new Date().toLocaleString('uk-UA')
                }
            };

            const dataStr = JSON.stringify(backupData, null, 2);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            const dateStr = new Date().toISOString().split('T')[0];
            downloadLink.download = `Perfume_Backup_V11.1_${dateStr}.json`;
            
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            showAdminMessage('‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞!', 'green');
        }

        function restoreBackup(inputElement) {
            const file = inputElement.files[0];
            if (!file) return;

            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const jsonContent = e.target.result;
                    const data = JSON.parse(jsonContent);
                    
                    if (!data.transactions || !data.perfumePrices) {
                        alert("‚ùå –ü–æ–º–∏–ª–∫–∞: –û–±—Ä–∞–Ω–∏–π —Ñ–∞–π–ª –Ω–µ —î –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö —Ü—ñ—î—ó –ø—Ä–æ–≥—Ä–∞–º–∏.");
                        return;
                    }

                    if (confirm(`‚ö†Ô∏è –£–í–ê–ì–ê!\n\n–í–∏ –∑–±–∏—Ä–∞—î—Ç–µ—Å—è –∑–∞–º—ñ–Ω–∏—Ç–∏ –í–°–Ü –ø–æ—Ç–æ—á–Ω—ñ –¥–∞–Ω—ñ –¥–∞–Ω–∏–º–∏ –∑ —Ñ–∞–π–ª—É –≤—ñ–¥ ${data.meta ? data.meta.date : '–Ω–µ–≤—ñ–¥–æ–º–æ—ó –¥–∞—Ç–∏'}.\n\n–ü–æ—Ç–æ—á–Ω—ñ –¥–∞–Ω—ñ –±—É–¥—É—Ç—å –≤—Ç—Ä–∞—á–µ–Ω—ñ. –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏?`)) {
                        
                        // –ú–∏ –ø–æ–≤–∏–Ω–Ω—ñ –æ–Ω–æ–≤–∏—Ç–∏ –∫–ª—é—á—ñ, —â–æ–± —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ –Ω–µ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É–≤–∞–ª–∏
                        localStorage.setItem(DB_NAME, JSON.stringify(data.transactions));
                        localStorage.setItem(EXPENSES_KEY, JSON.stringify(data.expenses || []));
                        localStorage.setItem(PRICES_KEY, JSON.stringify(data.perfumePrices));
                        localStorage.setItem(FLACONS_KEY, JSON.stringify(data.flaconCosts));
                        localStorage.setItem(VOLUMES_KEY, JSON.stringify(data.flaconVolumes));
                        
                        if (data.markupPresets) {
                            localStorage.setItem(MARKUP_PRESETS_KEY, JSON.stringify(data.markupPresets));
                        }
                        if (data.salesSources) {
                            localStorage.setItem(SALES_SOURCES_KEY, JSON.stringify(data.salesSources));
                        }

                        alert("‚úÖ –ë–∞–∑—É –¥–∞–Ω–∏—Ö —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ! –°—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–¥–µ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞.");
                        window.location.reload();
                    }
                } catch (err) {
                    alert("‚ùå –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —á–∏—Ç–∞–Ω–Ω—ñ —Ñ–∞–π–ª—É: " + err.message);
                }
            };
            
            reader.readAsText(file);
            inputElement.value = '';
        }
        
        // --- 15. –§—É–Ω–∫—Ü—ñ—è: –ï–∫—Å–ø–æ—Ä—Ç –ü—Ä–∞–π—Å–∞ –ö–ª—ñ—î–Ω—Ç–∞ (Text List) (–û–ù–û–í–õ–ï–ù–û V11.1) ---
        function downloadClientPriceList() {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø–µ—Ä—à–∏–π —Ç–∏–ø –Ω–∞—Ü—ñ–Ω–∫–∏ —è–∫ –±–∞–∑–æ–≤–∏–π (–†–æ–∑–¥—Ä—ñ–±)
            const retailMarkupName = Object.keys(MARKUP_PRESETS)[0]; 
            
            if (!retailMarkupName) {
                 showAdminMessage('–ü–æ–º–∏–ª–∫–∞: –ù–µ–º–∞—î –∂–æ–¥–Ω–æ–≥–æ —Ç–∏–ø—É –Ω–∞—Ü—ñ–Ω–∫–∏ –¥–ª—è —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø—Ä–∞–π—Å—É! –î–æ–¥–∞–π—Ç–µ —ó—ó –≤ –î–æ–≤—ñ–¥–Ω–∏–∫–∞—Ö.', 'red');
                 return;
            }
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∞–π—Å–∞
            let listContent = `–ü–†–ê–ô–°-–õ–ò–°–¢ (–¶—ñ–Ω–∞ –∑–∞ 1 –º–ª / –ù–∞—Ü—ñ–Ω–∫–∞: ${retailMarkupName})\n\n`;

            const sortedPerfumes = Object.keys(PERFUME_PRICES).sort();

            // –§–æ—Ä–º—É—î–º–æ —Å–ø–∏—Å–æ–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ "–ù–∞–∑–≤–∞ - –¶—ñ–Ω–∞/–º–ª"
            sortedPerfumes.forEach(name => {
                const data = PERFUME_PRICES[name];
                // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —Ü—ñ–Ω—É –ø—Ä–æ–¥–∞–∂—É 1 –º–ª –∑–≥—ñ–¥–Ω–æ —Ä–æ–∑–¥—Ä—ñ–±–Ω–æ—ó –Ω–∞—Ü—ñ–Ω–∫–∏
                const fixedSalePrice = calculateFixedSalePrice(data.basePrice, retailMarkupName); 
                
                // –§–æ—Ä–º–∞—Ç: –ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É - –¶—ñ–Ω–∞ (–∑–∞ 1 –º–ª) UAH
                listContent += `${name} - ${fixedSalePrice.toFixed(2)} UAH/–º–ª\n`; 
            });

            // –ó–º—ñ–Ω—é—î–º–æ —Ç–∏–ø —Ñ–∞–π–ª—É –Ω–∞ .txt
            const blob = new Blob([new TextEncoder().encode('\uFEFF' + listContent)], { type: 'text/plain;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            // –ó–º—ñ–Ω—é—î–º–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ .txt
            downloadLink.download = `Perfume_Client_Prices_List_${new Date().toISOString().split('T')[0]}.txt`; 
            
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            showAdminMessage('‚úÖ –§–∞–π–ª —ñ–∑ —Ü—ñ–Ω–∞–º–∏ –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ (Text List).', 'green');
        }
        
        // --- 16. –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ú–æ–¥–∞–ª—å–Ω–æ–≥–æ –ß–µ–∫–∞ (–ö–≤–∏—Ç–∞–Ω—Ü—ñ—ó) (–±–µ–∑ –∑–º—ñ–Ω) ---
        
        function generateReceiptHTML(orderItems, totalRounded, clientName) {
            const minDigits = ROUND_TO_NEAREST_UAH ? 0 : 2;
            const dateStr = new Date().toLocaleString('uk-UA');
            
            const clientInfo = clientName ? `<p style="margin: 0; font-weight: bold;">–ö–ª—ñ—î–Ω—Ç: ${clientName}</p>` : '';
            const markupInfo = orderItems[0] ? `<p style="margin: 0;">–¢–∏–ø –ù–∞—Ü—ñ–Ω–∫–∏: ${orderItems[0].markupTier}</p>` : '';

            let html = `
                <div class="receipt-header">
                    <h3>‚ú® –í–∞—à –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚ú®</h3>
                    ${clientInfo}
                    ${markupInfo}
                    <p style="margin: 0;">–î–∞—Ç–∞: ${dateStr}</p>
                </div>
                
                <table class="receipt-item-table">
                    <thead>
                        <tr>
                            <th style="width: 70%;">–ü–∞—Ä—Ñ—É–º —Ç–∞ –û–±'—î–º</th>
                            <th>–°—É–º–∞ (UAH)</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            orderItems.forEach(item => {
                const itemPriceFormatted = item.priceUnrounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits }); 
                html += `
                    <tr>
                        <td>${item.perfumeName} (${item.quantityML} –º–ª)</td>
                        <td>${itemPriceFormatted}</td>
                    </tr>
                `;
            });

            html += `
                    </tbody>
                </table>
                
                <div class="receipt-total">
                    –î–û –°–ü–õ–ê–¢–ò: ${totalRounded.toLocaleString('uk-UA', { minimumFractionDigits: minDigits })} UAH
                </div>

                <div class="receipt-footer">
                    –î—è–∫—É—î–º–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!
                </div>
                
                <div class="no-print admin-buttons-group" style="margin-top: 20px; text-align: center; display: flex; gap: 10px;">
                    <button onclick="window.print()" style="background-color: #28a745; flex-grow: 1;">üñ®Ô∏è –î—Ä—É–∫</button>
                    <button onclick="closeReceiptModal()" style="background-color: #6c757d; flex-grow: 1;">–ó–∞–∫—Ä–∏—Ç–∏</button>
                </div>
            `;
            return html;
        }
        
        function showReceiptModal(orderItems, totalRounded, clientName) {
            const modal = document.getElementById('receiptModal');
            const content = document.getElementById('receiptContent');
            content.innerHTML = generateReceiptHTML(orderItems, totalRounded, clientName);
            modal.classList.add('active');
        }
        
        function closeReceiptModal() {
            document.getElementById('receiptModal').classList.remove('active');
        }


        // –ó–∞–ø—É—Å–∫ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', () => {
            loadPerfumePrices(); 
            loadFlaconData(); 
            loadMarkupPresets(); 
            loadSalesSources(); 
            
            populateFormOptions();
            renderExpenseList(); 
            
            showSection('input-form', document.querySelector('#main-nav a'));
            renderOrderList(); 
        });
    </script>
</body>
</html>
